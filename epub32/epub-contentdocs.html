<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
<meta charset="utf-8" />
<title>EPUB Content Documents 3.2 日本語訳（2019年3月21日版）</title>
<script src="https://www.w3.org/Tools/respec/respec-w3c-common" class="remove"></script>
<script src="https://w3c.github.io/publ-epub-revision/epub32/spec/common/js/biblio.js" class="remove"></script>
<script src="https://w3c.github.io/publ-epub-revision/epub32/spec/common/js/dfn-crossref.js" class="remove"></script>
<script src="https://w3c.github.io/publ-epub-revision/epub32/spec/common/js/confreq-permalinks.js" class="remove"></script>
<script src="https://w3c.github.io/publ-epub-revision/epub32/spec/common/js/copyright.js" class="remove"></script>
<link href="https://w3c.github.io/publ-epub-revision/epub32/spec/common/css/common.css" rel="stylesheet" type="text/css" />
<script class="remove">
          var respecConfig = {
              wg: "EPUB 3 Community Group",
              wgURI: "https://www.w3.org/community/epub3/",
              wgPublicList: "public-epub3",
              specStatus: "CG-DRAFT",
              noRecTrack: true,
              shortName: "epub-contentdocs",
              prevRecURI: "https://www.idpf.org/epub/31/spec/epub-contentdocs-20170105.html",
              edDraftURI: "https://w3c.github.io/publ-epub-revision/epub32/spec/epub-contentdocs.html",
              copyrightStart: "1999",
              editors: [
                  {
                      name: "Dave Cramer",
                      company: "Hachette Book Group",
                      companyURL: "https://www.hachettebookgroup.com"
                  },
                  {
                      name: "Matt Garrish",
                      company: "DAISY Consortium",
                      companyURL: "https://www.daisy.org"
                  }
              ],
              formerEditors: [
                  {
                      name: "Elika J. Etemad",
                      company: "Invited Expert"
                  },
                  {
                      name: "Markus Gylling",
                      company: "International Digital Publishing Forum (IDPF)",
                      companyURL: "https://www.idpf.org"
                  },
                  {
                      name: "William McCoy",
                      company: "International Digital Publishing Forum (IDPF)",
                      companyURL: "https://www.idpf.org"
                  }
              ],
              processVersion: 2017,
              includePermalinks: true,
              permalinkEdge:     true,
              permalinkHide:     false,
              diffTool:          "http://www.aptest.com/standards/htmldiff/htmldiff.pl",
			  github:			 {
				  repoURL: "https://github.com/w3c/publ-epub-revision",
				  branch: "master"
			  },
              localBiblio: biblio,
              preProcess: [fixDefinitionCrossrefs, addConformanceLinks],
              postProcess: [fixCopyright]
          };
</script>
</head>
<body>
<section id="abstract">
<p>この仕様は、<a data-lt="EPUB Publication">EPUB® 出版物</a>のコンテキストで使用する HTML、SVG、CSS のプロファイルを定義する。</p>
<p>この仕様は、[[EPUB32]] を構成する<a href="epub-spec.html#sec-intro-epub-specs">仕様群</a>のひとつであり、XML や Web 規格に基づいたデジタル出版物の交換や配信形式である。この仕様は EPUB 3 を構成する以下の他の仕様と共に読み、理解することになっている。</p>
<p>この仕様と前身の多くの相違についての詳細情報は [[EPUB32Changes]] を参照されたい。</p>
</section>
<section id="sotd"></section>
<section id="sec-introduction">
<h1>まえがき</h1>

<section id="sec-overview-relations" class="informative">
<h2>他の仕様との関連性</h2>

<section id="sec-overview-relations-html">
<h3>HTML との関連性</h3>
<p>この仕様は、W3C [[HTML]] の特定のバージョンを参照しないが、その代わり、常に最新の勧告を指す日付なしの参照を使用する。このアプローチは、EPUB が常に HTML 規格の変更のペースを維持することを保証する。製作者とリーディング システムの開発者は、HTML の変更を追跡し続け、それらのプロセスやシステムが常に最新の状態に保たれていることを保証する必要があるだろう。</p>

<div class="caution">
<p>HTML の進化によって、以前のバージョンでは有効だった機能が、非推奨（Obsolete）や取り除かれる可能性がある。製作者のために最小限の混乱を保証するため、そのような変更を慎重に行うことを W3C に期待しているが、後方互換性のない版の場合は、日付のない参照の使用は見直されるかもしれない。</p>
</div>


<p><a href="#sec-xhtml">この仕様によって定義された XHTML プロファイル</a>は、他の仕様がない限り、[[HTML]] が提供するセマンティクスや構造、処理動作の全ての定義を継承する。</p>
<p>さらに、この仕様は、<a>製作者</a>によって <a>XHTML コンテンツ ドキュメント</a>に包含できる W3C HTML 文書モデルの<a href="#sec-xhtml-extensions">拡張セットを定義</a>をする。</p>
<p>この仕様は、スクリプトや HTML フォームもしくは HTML DOM のサポートを <a>EPUB リーディング システム</a>に要求しない。この仕様に準拠した リーディング システムは、適合した <a>EPUB コンテンツ ドキュメント</a>を処理することのみ期待される。<a href="#sec-scripted-content-rs-reqs">スクリプトや HTML フォームのサポート</a>が強制ではないように、適合したリーディング システムは、完全に準拠した HTML のユーザー エージェントでないかもしれない。</p>
</section>

<section id="sec-overview-relations-svg">
<h3>SVG との関連性</h3>
<p>この仕様は、W3C [[SVG]] の特定のバージョンを参照しないが、その代わり、日付なしの参照を使用する。この参照に曖昧さがある場合は常に、最新の推奨された仕様が正式な参照である。</p>
<p>このアプローチは、EPUB が常に SVG 規格の変更のペースを維持することを保証する。製作者とリーディング システムの開発者は、SVG の変更を追跡し続け、それらのプロセスやシステムが常に最新の状態に保たれていることを保証する必要があるだろう。</p>

<div class="caution">
<p>SVG の進化によって、以前のバージョンでは有効だった機能が、非推奨（Obsolete）や取り除かれる可能性がある。製作者のために最小限の混乱を保証するために、そのような変更を慎重に行うことを W3C に期待しているが、後方互換性のない版の場合は、日付のない参照の使用は見直されるかもしれない。</p>
</div>
</section>

<section id="sec-overview-relations-css">
<h3>CSS との関連性</h3>
<p>EPUB 3 は、CSS ワーキング グループ スナップショット [[CSSSnapshot]] によって定義される CSS をサポートする。EPUB 3 はまた、グローバルな言語の一貫したサポートを確実にするために、いくつかのプリフィックス付き CSS プロパティを保持する。</p>
</section>
</section>

<section id="sec-terminology">
<h2>用語</h2>
<p>EPUB 3 固有の意味を持つ用語は、このドキュメント（例えば、「製作者」、「リーディング システム」）に利用できる。これらの<a href="epub-spec.html#sec-terminology">用語と定義</a>の完全なリストは、[[!EPUB32]] で提供されている。</p>
<p>セクションにある用語の最初のインスタンスのみが、その定義にリンクされる。</p>
</section>

<section id="conformance"></section>

<section id="sec-overview-pfx">
<h2>名前空間プリフィックスのマッピング</h2>
<p>便宜上、次の名前空間プリフィックス [[!XML-NAMES]] は、明示的に宣言されることなく、この仕様で使用される。<a>EPUB コンテンツ ドキュメント</a>でこれらのプリフィックスを使用するに、宣言は必須である（REQUIRED）。</p>
<table class="mapping">
<tr>
<th>プリフィックス</th>
<th>URI</th>
</tr>
<tr>
<td><code>epub</code></td>
<td><code>http://www.idpf.org/2007/ops</code></td>
</tr>
<tr>
<td><code>ssml</code></td>
<td><code>https://www.w3.org/2001/10/synthesis</code></td>
</tr>
</table>
</section>
</section>
<section id="sec-xhtml">
<h1>XHTMLコンテンツ ドキュメント</h1>

<section id="sec-xhtml-intro">
<h2>まえがき</h2>

<p>この仕様は、XHTML コンテンツ ドキュメント制作のために [[!HTML]] のプロファイルを定義する。このプロファイルに準拠する XML ドキュメントのインスタンスは<a>コア メディア タイプ リソース</a>であり、<a>XHTML コンテンツ ドキュメント</a>としてこの仕様で言及される。</p>

<p>他の指定のない限り、この仕様は、[[!HTML]] 仕様からセマンティクスと構造、処理動作の全ての定義を継承する。</p>
</section>

<section id="sec-xhtml-conf-content">
<h2>コンテンツの適合性</h2>

<p><a>XHTML コンテンツ ドキュメント</a>は、次の基準を全て満たさなければならない（MUST）。</p>

<dl class="conformance-list">
<dt id="confreq-cd-html-docprops">ドキュメントのプロパティ</dt>
<dd><p id="confreq-cd-html-docprops-syntax"><a href="https://www.w3.org/TR/html/xhtml.html#xhtml">XHTML</a> 構文に従った [[!HTML]] ドキュメントでなければならない（MUST）。</p>
<p id="confreq-cd-html-xml"><a href="epub-spec.html#sec-xml-constraints">XML 適合性</a> [[!EPUB32]] で定義された XML ドキュメントの適合性の制約を満たさなければならない（MUST）。</p>
<p id="confreq-cd-html-docprops-html">全てのドキュメントの為に使用されている構成概念は [[!HTML]] により定義され、それは <a href="#sec-xhtml-deviations">HTML の許容性と制約</a>で明確に上書きされていない限り、その仕様でこれらの構成概念のために定義された適合性の基準に準拠しなければならない（MUST）。</p>
<p id="confreq-cd-html-docprops-schema"><a href="#sec-xhtml-extensions">HTML の拡張</a>で定義されている [[!HTML]] 文法の拡張を包含してもよく（MAY）、これらに定義されている全てのコンテンツの適合性の制約に適合しなければならない（MUST）。</p>
<div class="note">
<p>[[EPUBAccessibility]] のアクセシビリティ要件に従う EPUB 出版物の推奨は、XHTML コンテンツ ドキュメントに適用する。<a href="epub-spec.html#sec-epub-a11y">アクセシビリティ</a> [[EPUB32]] を見よ。</p>
</div>
</dd>
<dt id="confreq-cd-html-fileprops">ファイルのプロパティ</dt>
<dd><p id="confreq-cd-xhtml-fileprops-name">XHTML コンテンツ ドキュメントのファイル名は、ファイル拡張子 <code>.xhtml</code> を使用するべきである（SHOULD）。</p></dd>
</dl>
</section>

<section id="sec-xhtml-conf-rs">
<h2>リーディング システムの適合性</h2>
<p>適合した <a>EPUB リーディング システム</a>は、<a>XHTML コンテンツ ドキュメント</a>の処理のために、次の基準を全て満たさなければならない（MUST）：</p>
<ul class="conformance-list">
<li><p id="confreq-html-rs-behavior">この仕様によって上書きなどが明確に定義されていない限り、[[!HTML]] 仕様により定義されたセマンティクスを使用して XHTML コンテンツ ドキュメントを処理し、その中に表れる適切なユーザー エージェントの適合性の制約を尊重しなければならない（MUST）。</p></li>
<li><p id="confreq-html-rs-behavior-add"><a href="#sec-xhtml-extensions">HTML の拡張</a>で定義された全てのリーディング システムの適合性基準を満たさなければならない（MUST）。</p></li>
<li><p id="confreq-html-rs-behavior-restr"><a href="#sec-xhtml-deviations">HTML の許容性と制約</a>で定義された制約の挙動を認識し、適応しなければならない（MUST）。</p></li>
<li><p id="confreq-html-rs-scrpt"><a href="#sec-scripted-content-rs-reqs">スクリプト コンテンツ ドキュメント — リーディング システムの適合性</a>で定義されたリーディング システムの適合性基準を満たさなければならない（MUST）。</p></li>
<li><p id="confreq-html-rs-css"><a href="#sec-css-rs-conf">CSS スタイル シート — リーディング システムの適合性</a>で定義された XHTML コンテンツ ドキュメントの視覚的レンダリングをサポートしなければならない（MUST）。</p></li>
<li><p id="confreq-html-rs-a11y">埋め込まれた ARIA マークアップを認識し、アクセシビリティ APIs [[!WAI-ARIA]] の任意の ARIA ロール（role）やステート（state）、プロパティ（property）がプラットフォームに出現するのをサポートするべきである（SHOULD）。</p></li>
</ul>
</section>

<section id="sec-xhtml-extensions">
<h2>HTML の拡張</h2>

<p>このセクションは、[[!HTML]] ドキュメント モデルを基礎にして、EPUB 3 の <a>XHTML コンテンツ ドキュメント</a>の拡張を定義する。</p>

<div class="note">
<p>このような拡張がこのセクションに掲載されていない限り、[[HTML]] は、<a href="https://www.w3.org/TR/html5/infrastructure.html#conformance-requirements-extensibility">ベンダーの中立的な拡張</a>のサポートをユーザーエージェントに許可しているが、それらは、EPUB 3 でサポートされた機能ではない。</p>
</div>

<section id="sec-xhtml-semantic-inflection">
<h3>意味の変化</h3>

<section id="sec-xhtml-semantic-inflection-intro" class="informative">
<h4>まえがき</h4>
<p>意味の変化は <a>XHTML コンテンツ ドキュメント</a>内で使用している要素に特定の意味と、または性質に関するさらなる意味を付与する行為である。<a href="#sec-epub-type-attribute"><code>epub:type</code> 属性</a>は、[[HTML]] の語彙を補足する変化をもたらし、XHTML コンテンツ ドキュメント内のドメイン固有の意味を表現するのに使用される。</p>
<p>適用されるセマンティクスは、それらを含んでいる要素の意味を取り込むことが意図されており、（例えば、属性は、<code>section</code> が作品の章を示すために使用できるが、適切なリスト構造を回避するために、リスト項目に <code>p</code> 要素を動作するもとして設計されていないように）それらの性質を上書きするために提供されていない。</p>
<p>セマンティック メタデータは直接人間に提供されることを目的にしておらず、その代わりにドキュメントの構造とコンテンツについてのより詳細にリーディング システムのために制御方法を提供し、読者のために読書体験を向上させる良い機会を提供する。</p>
<p>この仕様は、新しい要素を追加する代わりに、<em>axis 属性</em>を使用して意味の変化のための方法を定義し、<code>epub:type</code> 属性で求められる意味の変化を既存の要素に付与できる。属性の制御値を提供する外部のボキャブラリを識別するためのメカニズムもまた定義されている。</p>
</section>

<section id="sec-epub-type-attribute">
<h4><code>epub:type</code> 属性</h4>

<dl class="elemdef" id="attrdef-epub-type">
<dt>属性名</dt>
<dd><p><code>type</code></p></dd>
<dt>名前空間</dt>
<dd><p> <code>http://www.idpf.org/2007/ops</code> </p></dd>
<dt>使用方法</dt>
<dd><p><a href="https://www.w3.org/TR/html/dom.html#global-attributes">グローバル属性</a>。全ての要素に指定してもよい（MAY）。</p></dd>
<dt>値</dt>
<dd><p><a href="#sec-contentdocs-vocab-association">語彙の関連性</a>で定義された制約による、<a href="epub-packages.html#sec-property-datatype">プロパティ</a> [[!Packages32]] 値の空白で区切られたリスト。</p>
<p>空白は、[[!XML]] に定義されている文字の集合である。</p></dd>
</dl>
<p><code>epub:type</code> 属性は、それが出現する要素の意味を変化させる。その値は、<a href="#sec-contentdocs-vocab-association">語彙の関連性</a>で定義された文書のインスタンスに関連付けられた外部の語彙から抽出される空白で区切られたひとつ以上の用語である。</p>
<p>変化された意味は、含んでいる要素の意味のサブクラスを表現しなければならない（MUST）。例えば [[!HTML]] の <a href="https://www.w3.org/TR/html/grouping-content.html#the-div-element"><code>div</code></a> や <a href="https://www.w3.org/TR/html/textlevel-semantics.html#the-span-element"><code>span</code></a> 要素など、意味的に中立な要素の場合、変化された意味は、（例えば、<code>div</code> は段落や節を表現している）既存の要素によってすでに含まれている意味を加えてはならない（MUST NOT）。リーディング システムは含んでいる要素と矛盾する<a href="#confreq-rs-epubtype-prec">変化された意味を無視</a>しなければならない（MUST）。</p>
<p>[[!HTML]] <a href="https://www.w3.org/TR/html/document-metadata.html#the-head-element"><code>head</code></a> 要素がドキュメントのメタデータを含むように、構造的なセマンティクスは、この要素上または意味を持たない任意の子孫に表れる。リーディング システムは、これらのセマンティクスを無視しなければならない（MUST）。</p>

<h4>例</h4>

<aside class="example" id="ex.epubtype.note">
<p>次の例は、序文が、[[HTML]] <code>section</code> 要素に含まれていることを <code>epub:type</code> 属性でマークアップできる方法を示している。</p>
<pre>
&lt;html … xmlns:epub="http://www.idpf.org/2007/ops"&gt;
    …
    &lt;section epub:type="preamble"&gt;
        …    
    &lt;/section&gt;
    …
&lt;/html&gt;</pre>
</aside>



<aside class="example" id="ex.epubtype.gloss">
<p>次の例は、[[HTML]] の定義リストに用語集のセマンティクスを追加するために用いられる <code>epub:type</code> 属性を示している。</p>
<pre>
&lt;html … xmlns:epub="http://www.idpf.org/2007/ops"&gt;
    …
    &lt;dl epub:type="glossary"&gt;
        …    
    &lt;/dl&gt;        
    …
&lt;/html&gt;</pre>
</aside>



<aside class="example" id="ex.epubtype.pg">
<p>次の例は、改ページのセマンティクスを追加するために使用する <code>epub:type</code> 属性を示している。</p>
<pre>
&lt;html … xmlns:epub="http://www.idpf.org/2007/ops"&gt;
   …
  &lt;p&gt; … &lt;span epub:type="pagebreak" id="p234"/&gt; … &lt;/p&gt;    
   … 
&lt;/html&gt;</pre>
</aside>

</section>

<section id="sec-contentdocs-vocab-association">
<h4>語彙の関連性</h4>

<p>この仕様は、次の変更を伴う<a href="epub-packages.html#sec-metadata-assoc">語彙の関連付けメカニズム</a> [[!Packages32]] で定義された語彙の関連性メカニズムを採用する。</p>

<section id="sec-contentdocs-default-vocab">
<h5>標準の語彙</h5>

<p>コンテンツ ドキュメントの標準の語彙は、[[!EPUB-SSV]] で定義される。[[!EPUB-SSV]] の一部でないプリフィックスがつかない用語を包含してもよいが（MAY）、これらの使用は、推奨されない。プリフィックスの使用は、カスタム セマンティクスを追加するための望ましい方法である。</p>
</section>

<section id="sec-contentdocs-reserved-prefixes">
<h5>予約済みのプリフィックス</h5>

<p>製作者は、宣言をすることなく、<code>epub:type</code> 属性に次の予約済みのプリフィックスを使用してもよい（MAY）。</p>

<p class="warning">予約済みのプリフィックスは、オーサリング時に便利だが、それらの依存は、相互互換性の問題に繋がる。適合性ツールは、ツールが更新されるまで、新しいプリフィックスを拒否するだろう。製作者は、このような問題を避けるために、使用する全てのプリフィックスを宣言することを強く推奨する。</p>

<table id="tbl-reserved-prefixes" class="prefix">
<thead>
<tr>
<th>プリフィックス</th>
<th>IRI</th>
</tr>
</thead>
<tbody>
<tr>
<td>msv</td>
<td>http://www.idpf.org/epub/vocab/structure/magazine/#</td>
</tr>
<tr>
<td>prism</td>
<td>http://www.prismstandard.org/specifications/3.0/PRISM_CV_Spec_3.0.htm#</td>
</tr>
</tbody>
</table>
</section>

<section id="sec-contentdocs-prefix-attr">
<h5>prefix 属性</h5>

<p><code>prefix</code> 属性の定義は変わらないが、属性は EPUB コンテンツ ドキュメント内で使用されるとき、名前空間 <code>http://www.idpf.org/2007/ops</code> で定義される。</p>

<p><code>prefix</code> 属性は、[[!HTML]] のルート <code>html</code> 要素のみ有効である。</p>
</section>
</section>

<section id="sec-contentdocs-semantic-inflection-processing-reqs">
<h4>処理の要件</h4>

<p>リーディング システムは、次のように <code>epub:type</code> 属性を処理しなければならない（MUST）。</p>

<ul class="conformance-list">
<li><p id="confreq-rs-epubtype-beh"><a href="#sec-contentdocs-default-vocab">標準の語彙</a>で定義されている用語のいくつかまたは全てに、動作を結びつけなくてもよい（MAY）。</p></li>
<li><p id="confreq-rs-epubtype-oth">他の語彙からの用語に、動作を結びつけてもよい（MAY）。</p></li>
<li><p id="confreq-rs-epubtype-ign">認識できない用語を無視しなければならない（MUST）。</p></li>
</ul>

<p id="confreq-rs-epubtype-prec">指定した <code>epub:type</code> 値に関連付けられているリーディング システムの動作がネイティブの動作と衝突するとき、要素に関連付けられている動作の優先順位を指定しなければならない（MUST）。</p>
</section>
</section>

<section id="sec-xhtml-semantic-enrichment">
<h3>意味の強化</h3>

<section id="sec-xhtml-semantic-enrichment-intro" class="informative">
<h4>まえがき</h4>

<p>マークアップした構造を改良することに関して、<a href="#sec-xhtml-semantic-inflection">意味の変化</a>とは異なり、意味の強化は、機械の処理を容易にするためにコンテンツ内の意味の階層化を可能にする。</p>

<p>[[Microdata]] と [[RDFA-CORE]] 仕様の両方は、コンテンツを意味論的に強化する <a>XHTML コンテンツ ドキュメント</a>で使用できる属性のセットを定義する。</p>
</section>

<section id="sec-xhtml-sementic-enrichment-rdfa">
<h4>RDFa</h4>

<p>[[!RDFA-CORE]] 属性の使用は、<a>XHTML コンテンツ ドキュメント</a>で許可されているが、全ての使用方法は、[[!HTML+RDFA]] に定義されている要件に適合しなければならない（MUST）。</p>

<p>[[!RDFA-CORE]] 仕様は、RDFa 属性を使用したときの [[!HTML]] コンテンツ モデルの変更を定義している。この修正されたコンテンツ モデルは、XHTML コンテンツ ドキュメントに妥当である。</p>

<p><a href="https://www.w3.org/TR/2015/REC-rdfa-core-20150317/#s_model">属性処理モデル</a> [[!RDFA-CORE]] の <a>EPUB リーディング システム</a>のサポートは、省略可能（OPTIONAL）である。</p>
</section>

<section id="sec-xhtml-sementic-enrichment-microdata">
<h4>Microdata</h4>

<p>[[!Microdata]] 属性の使用は、<a>XHTML コンテンツ ドキュメント</a>で許可されているが、全ての使用方法は、[HTML+RDFa11] に定義されている要件に適合しなければならない（MUST）。</p>

<p>[[!Microdata]] 仕様は、マイクロデータの属性を使用したときの [[!HTML]] コンテンツ モデルの変更を定義している。この修正されたコンテンツ モデルは、XHTML コンテンツ ドキュメントに妥当である。</p>

<p><a href="https://www.w3.org/TR/microdata/#json">JSON への変換</a> [[!Microdata]] と同様に、<a href="https://www.w3.org/TR/microdata/#encoding-microdata">属性処理モデル</a>に対する <a>EPUB リーディング システム</a>のサポートは省略可能（OPTIONAL）である。</p>
</section>
</section>

<section id="sec-xhtml-ssml-attrib">
<h3>SSML 属性</h3>

<section id="sec-cd-ssml-intro">
<h4>まえがき</h4>

<p>W3C Speech Synthesis Markup Language [[!SSML]] は、同期スピーチを生成する<a>テキスト読み上げ</a>（TTS）エンジンを支援するために使われる言語である。SSML は独立したドキュメント形式として設計されているが、他のマークアップ言語内で使用するのにも適した意味も定義している。</p>

<p>この仕様は、[[!SSML]] <a href="https://www.w3.org/TR/2010/REC-speech-synthesis11-20100907/#S3.1.10"><code>phoneme</code> 要素</a>の二つの属性（<code>ssml:ph</code> と <code>ssml:alphabet</code>）について見直し、XHTML コンテンツ ドキュメント内で利用可能にする。</p>

<p><a>テキスト読み上げ</a>（TTS）機能のあるリーディング システムは上記で定義されている SSML 属性をサポートするべきである（SHOULD）。</p>

<div class="note">
<p>同期スピーチに関連する EPUB 3 の機能に関するより詳細な情報は、<a href="epub-overview.html#sec-tts">テキスト読み上げ</a> [[EPUB3Overview]] を参照されたい。</p>
</div>

</section>

<section id="sec-cd-ssml-ph-attrib">
<h4><code>ssml:ph</code> 属性</h4>

<p><code>ssml:ph</code> 属性は、属性を加えられた要素によって表現されるテキストとしての発話音素や発音記号表記を規定している。</p>

<dl class="elemdef" id="attrdef-ssml-ph">
<dt>属性名</dt>
<dd><p><code>ph</code></p></dd>
<dt>名前空間</dt>
<dd><p><code>https://www.w3.org/2001/10/synthesis</code></p></dd>
<dt>使用方法</dt>
<dd><p><a href="https://www.w3.org/TR/html/dom.html#global-attributes">グローバル属性</a>。当て字は論理的に関連付ける（例えば、テキスト情報が含まれている要素）ことのできる全ての要素に指定してもよい（MAY）。</p>
<p>すでにこの属性を含んでいる要素の子孫に指定してはならない（MUST NOT）。</p></dd>
<dt>値</dt>
<dd><p><a href="#sec-cd-ssml-alphabet-attrib">使用されている音韻字母/音声記号</a>に関する構文的に妥当な音素表現/表音。</p></dd>
</dl>

<p>この属性は、次を追加した <a href="#refSSML">[<abbr class="abbrev">SSML</abbr>]</a> <code>phoneme</code> 要素 <a class="markup" href="https://www.w3.org/TR/2010/REC-speech-synthesis11-20100907/#S3.1.10"><code>ph</code></a> 属性の全てのセマンティクスを継承する。</p>

<ul class="conformance-list">
<li><p id="ssml-ph-concat"><code>ssml:ph</code> 属性がテキスト ノードの子孫要素に出現するとき、発音を適用するのに対応するドキュメントのテキストは、ドキュメントの順で、対応する子孫のテキスト ノードの結果を一続きにする。指定された発音記号表記は、（すなわち、その内容の孤立した部分だけではなく）全体の中のテキスト データの要素と論理的に一致しなければならない（MUST）。</p></li>
</ul>

<p>SSML の属性と <a href="#sec-pls">PLS ドキュメント</a>をサポートするリーディング システムは、これらの二つの構造のために定義された<a href="#confreq-pls-rs-casc">優先順位の規則</a>を履行しなければならない（MUST）。</p></section>
</section>

<section id="sec-cd-ssml-alphabet-attrib">
<h4><code>ssml:alphabet</code> 属性</h4>

<p><code>ssml:alphabet</code> 属性は、発話音素や発音記号表記のアルファベットが <a href="#attrdef-ssml-ph"><code>ssml:ph</code></a> 属性の値で使用されることを規定している。</p>

<dl class="elemdef" id="attrdef-ssml-alphabet">
<dt>属性名</dt>
<dd><p><code>alphabet</code></p></dd>
<dt>名前空間</dt>
<dd><p><code>https://www.w3.org/2001/10/synthesis</code></p></dd>
<dt>使用方法</dt>
<dd><p><a href="https://www.w3.org/TR/html/dom.html#global-attributes">グローバル属性</a>。任意の要素に指定してもよい（MAY）。</p></dd>
<dt>値</dt>
<dd><p>（継承した）<a href="#attrdef-ssml-ph"><code>ssml:ph</code></a> の値で使用される発音アルファベットの名前。</p></dd>
</dl>

<p>この属性は、次の追加を伴った、<a href="#refSSML">[<abbr class="abbrev">SSML</abbr>]</a> <code>phoneme</code> 要素 <a class="markup" href="https://www.w3.org/TR/2010/REC-speech-synthesis11-20100907/#S3.1.10"><code>alphabet</code></a> 属性の全てのセマンティクスを継承する：</p>

<ul class="conformance-list">
<li><p id="ssml-alphabet-inherit"><code>ssml:alphabet</code> 属性の値はドキュメントツリーに継承される。指定された <code>ssml:ph</code> 属性値に使用される発話アルファベットは、最も近い親要素に続く、<code>ssml:ph</code> 属性が出現する要素から始まる <code>ssml:alphabet</code> 属性の最初に発生する位置によって決定される。</p></li>
</ul>

<div class="note">
<p>[[SSML]] 仕様は、アルファベットのレジストリを参照していますが、公開されていない。W3C Voice Browser ワーキング グループの憲章は有効期限が切れているため、このようなレジストリの公開は期待されない。したがって、製作者は、サポートされているアルファベット値を決定するために、リーディング システムのサポートドキュメントを参照する必要がある。x-JEITA（x-JEITA-IT-4002 と x-JEITA-IT-4006）および x-sampa などの一般的なアルファベットも包含する。</p>
</div>

<p>この仕様の <a href="#sec-xhtml-ssml-attrib">SSML 属性</a>の機能をサポートするリーディング システムは、値「<code>ipa</code>」で表現される IPA アルファベット [[!IPA]] をサポートするべきである（SHOULD）。</p>
</section>
</section>

<section id="sec-xhtml-content-switch">
<h3>コンテンツの切り替え（非推奨）</h3>

<p><code>switch</code> 要素は、<a>EPUB リーディング システム</a>のスクリプト機能に依存せず、<a>製作者</a>が、読者へ表示するコンテンツを調整できる単純なメカニズムを提供する。</p>

<p><code>switch</code> 要素の使用は、非推奨（<a href="epub-spec.html#deprecated">deprecated</a>）である。使用法の情報は、[[!ContentDocs301]] の定義を参照されたい。</p>
</section>

<section id="sec-xhtml-epub-trigger">
<h3><code>epub:trigger</code> 要素（非推奨）</h3>

<p><code>trigger</code> 要素は、スクリプト化及び非スクリプト化のコンテキストの両方において、例えば、音声や動画の再生など、マルチメディア オブジェクトを制御するマークアップ定義のユーザー インターフェースの作成を可能にする。</p>

<p><code>trigger</code> 要素の使用は、非推奨（<a href="epub-spec.html#deprecated">deprecated</a>）である。使用法の情報は、[[!ContentDocs301]] の定義を参照されたい。</p>
</section>

<section id="sec-xhtml-custom-attributes">
<h3>カスタム属性</h3>

<p><a>リーディング システム</a>は、<a>EPUB 出版物</a>のレンダリングを強化するために、この仕様で定義されていない機能を導入してもよい（MAY）。この実験を容易にするために、ベンダーは、<a>XHTML コンテンツ ドキュメント</a>で使用するためにカスタム属性を定義してもよい（MAY）。</p>

<p>カスタム属性は、次の URI のいずれにも一致しない名前空間 [[!XML-NAMES]] として定義されている外部の名前空間から、そのような属性が提供されている XHTML コンテンツ ドキュメント内の任意の要素に包含されてもよい（MAY）。</p>

<ul>
<li>
<p><code>http://www.w3.org/1999/xhtml</code></p></li>
<li>
<p><code>http://www.idpf.org/2007/ops</code></p></li>
</ul>

<p>カスタム属性と、それに結びついた挙動は、EPUB 出版物の整合性を変更してはならない（MUST NOT）。コンテンツは、リーディング システムのレンダリングに関わらず、任意の情報の損失や他の重要な劣化なしに、読者によって消費できるままにしなければならない（MUST）。</p>

<div class="note">
<p>リーディング システムを横断するカスタム属性の相互互換性を容易にするために、ベンダーは、[[AttributeExtensions]] で実装される任意の拡張をドキュメント化することを強く推奨する。</p>
</div>
</section>
</section>

<section id="sec-xhtml-deviations">
<h2>HTML の許容性と制約</h2>

<p>このセクションは、EPUB 3 の <a>XHTML コンテンツ ドキュメント</a>で許可されている基本的な [[!HTML]] ドキュメントモデルから許容性と制約を定義する。</p>

<section id="sec-xhtml-mathml">
<h3>埋め込み MathML</h3>

<section id="sec-xhtml-mathml-intro" class="informative">
<h4>まえがき</h4>

<p>XHTML コンテンツ ドキュメントは、埋め込み [[MATHML3]] をサポートするが、完全な MathML マークアップ言語の制限されたサブセットの使用法に限定をする。</p>

<p>このサブセットは、[[HTML]] ユーザー エージェントとの互換性を保持しながら、リーディング システムの実装負荷の軽減とアクセシビリティを促進するよう設計されている。</p>

<div class="note">
<p><a>マニフェスト</a> <code>item</code> 要素の <a href="epub-packages.html#mathml"><code>mathml</code> プロパティ</a> は、XHTML コンテンツ ドキュメントが埋め込み MathML を含んでいることを示している。</p>
</div>

</section>

<section id="sec-xhtml-mathml-conf-content">
<h4>コンテンツの適合性</h4>

<p>XHTML コンテンツ ドキュメント内の MathML マークアップのいずれかの発生には、次にある追加の制約付きで、MathML 仕様 [[!MATHML3]] 内に述べられている制約に準拠しなければならない（MUST）。</p>

<dl class="conformance-list">
<dt id="math-pres">Presentation MathML</dt>
<dd><p id="confreq-mathml-pres"><code>math</code> 要素は、下で定義しているような <code>annotation-xml</code> 要素を除外して、<a href="https://www.w3.org/TR/MathML3/chapter3.html">Presentation MathML</a> のみ含まなければならない（MUST）。</p></dd>
<dt id="math-cont">Content MathML</dt>
<dd><p id="confreq-mathml-annot-cont"><a href="https://www.w3.org/TR/MathML3/chapter4.html">Content MathML</a> は、XHTML コンテンツ ドキュメントの MathML マークアップ内に包含してもよく（MAY）、そして、表示されるとき、<code>semantics</code> 要素の <code>annotation-xml</code> 子要素に生じなければならない（MUST）。</p>
<p id="confreq-mathml-annot-cont-attrs">Content MathML は、上記の条件のように包含するとき、指定された <code>annotation-xml</code> 要素の <code>encoding</code> 属性は、機能的に同等な値の <code>MathML-Content</code> かそれとも <code>application/mathml-content+xml</code> を設定しなければならず（MUST）、その <code>name</code> 属性は <code>contentequiv</code> に設定されなければならない（MUST）。</p></dd>
<dt id="math-deprecated">Deprecated MathML</dt>
<dd><p id="confreq-mathml-deprecated">[[!MATHML3]] で非推奨にマークされた要素と属性は、XHTML コンテンツ ドキュメントの MathML マークアップ内に包含してはならない（MUST NOT）。</p></dd>
<dt id="math-html">XHTML コンテンツ ドキュメント フラグメント</dt>
<dd><p id="confreq-mathml-annot-xht">XHTML コンテンツ ドキュメント フラグメントは、XHTML コンテンツ ドキュメントの MathML マークアップ内に包含してもよく（MAY）、そして、表示されるとき、<code>semantics</code> 要素の <code>annotation-xml</code> 子要素内に発生しなければならない（MUST）。</p>
<p id="confreq-mathml-annot-xht-attrs">XHTML コンテンツ ドキュメント フラグメントが上記段落経由で包含されるとき、指定された <code>annotation-xml</code> 要素の <code>encoding</code> 属性は、<code>application/xhtml+xml</code> を設定されなければならず（MUST）、<code>name</code> 属性は、<code>alternate-representation</code> に設定されなければならない（MUST）。</p>
<p id="confreq-mathml-annot-xht-math">全ての包含された XHTML コンテンツ ドキュメント フラグメントは、MathML マークアップ自体を含んではならない（MUST NOT）。</p>
<p id="confreq-mathml-annot-xht-model">全ての包含された XHTML コンテンツ ドキュメント フラグメントは、<code>math</code> 要素が、特定の XHTML コンテンツ ドキュメント フラグメントによって置き換えられた場合、ドキュメントは妥当なまま、祖先の <code>math</code> 要素が発生するコンテンツ モデルに適合しなければならない（MUST）、</p></dd>
</dl>
</section>

<section id="sec-xhtml-mathml-rs-conf">
<h4>リーディング システムの適合性</h4>
<p>適合した <a>EPUB リーディング システム</a>は、XHTML コンテンツ ドキュメントに埋め込まれた MathML をサポートするために次の基準を全て満たさなければならない（MUST）。</p>
<ul class="conformance-list">
<li><p id="confreq-mathml-rs-behavior">[[!MATHML3]] 仕様で定義されているように、<a href="https://www.w3.org/TR/MathML3/chapter3.html">Presentation MathML</a> の入力に対応するレンダラーでなければならない（MUST）。</p></li>
<li><p id="confreq-mathml-rs-anno"><code>xml-annotation</code> 要素にある <a href="https://www.w3.org/TR/MathML3/chapter4.html">Content MathML</a> のレンダリングをサポートしてもよい（MAY）。</p></li>
<li><p id="confreq-mathml-rs-render"><a>ビューポート</a>を持つ場合、Presentation MathML の視覚的なレンダリングをサポートしなければならない（MUST）。</p></li>
</ul>
<p class="note">EPUB リーディング システムは、例えば MathML のレンダリングを提供する MathJax など、サードパーティのライブラリの使用を選択してもよい（MAY）。</p>
</section>






</section>

<section id="sec-xhtml-svg">
<h3>埋め込み SVG</h3>

<p><a>XHTML コンテンツ ドキュメント</a>は、（参照を介しての埋め込み、たとえば、<code>img</code> や <code>object</code> 要素による） <em>参照</em>と、（XHTML コンテンツ ドキュメント内の <code>svg</code> 要素の直接な包含を介しての埋め込みによる）<em>包含</em>による <a href="https://www.w3.org/TR/SVG/intro.html#TermSVGDocumentFragment">SVG ドキュメント フラグメント</a> [[!SVG]] の埋め込みをサポートする。</p>

<p>XHTML コンテンツ ドキュメントに埋め込まれた SVG のコンテンツの適合性の制約は、<a href="#sec-svg-restrictions">SVG の制約</a>の <a>SVG コンテンツ ドキュメント</a>ために定義されたものと同じである。</p>

<p>リーディング システムは、<a href="#sec-svg-rs-conf">SVG コンテンツ ドキュメント - リーディング システムの適合性</a> に定義された XHTML コンテンツ ドキュメントに埋め込まれた SVG を処理しなければならない（MUST）。</p>

<div class="note">
<p><a>マニフェスト</a> <a href="epub-packages.html#sec-item-elem"><code>item</code> 要素</a> [[Packages32]] の <a href="epub-packages.html#svg"><code>svg</code> プロパティ</a>は、XHTML コンテンツ ドキュメントに埋め込み SVG を含んでいることを示している。</p>
</div>



<section id="sec-xhtml-svg-css">
<h4>埋め込み SVG と CSS</h4>
<p id="confreq-svg-rs-css-embed-ref"><em>参照</em>によって XHTML コンテンツ ドキュメントに埋め込まれた SVG のスタイリングのために、リーディング システムは、参照先の SVG ドキュメントに含まれるドキュメントの CSS スタイル ルールを適用してはならない（MUST NOT）。</p>
<p id="confreq-svg-rs-css-embed-inc"><em>包含</em>によって XHTML コンテンツ ドキュメントに埋め込まれた SVG のスタイリングのために、リーディング システムは、包含された SVG 要素に含まれているドキュメントの CSS ルールを適用しなければならない（MUST）。</p>

<div class="note">
<p><em>参照によって</em>包含された SVG は、別のドキュメントのように処理され、<a>SVG コンテンツ ドキュメント</a>と同様に独自の CSS スタイル ルールを包含できる。これは、外部の [[HTML]] 要素を参照する [[HTML]] <a href="https://www.w3.org/TR/html/semantics-embedded-content.html#elementdef-object"><code>object</code></a> 要素の状況と一致していると注意されたい。</p>
</div>

</section>
</section>

<section id="sec-xhtml-deviations-unicode">
<h3>Unicode の制限</h3>
<p>本セクションは、Unicode 文字のレパートリーの制約を記載する。</p>

<dl class="variablelist">
<dt>外字文字と埋め込みフォント</dt>
<dd><p id="confreq-html-unicode-pua">[[!Unicode]] に定義された通りに私用領域（PUA）範囲のひとつの中の符号位置にマッピングされた任意の包含された文字は、その符号位置のために適したグリフを含む埋め込みフォント [[!CSS-Fonts-3]] を参照し包含する方法で、設定または起因し、文字列内に発生しなければならない（MUST）。</p></dd>
</dl>
</section>

<section id="sec-xhtml-deviations-discouraged" class="informative">
<h3>推奨されない構造</h3>

<section id="sec-xhtml-deviations-rp">
<h4><code>rp</code> 要素</h4>
<p id="confreq-html-vocab-rp">[[HTML]] <a href="https://www.w3.org/TR/html/textlevel-semantics.html#the-rp-element"><code>rp</code></a> 要素は、（例えば、丸括弧表示で囲む <code>ruby</code> マークアップなど）ルビのマークアップを見分けられない古い<a>リーディング システム</a>のためのフォールバックの提供を意図している。EPUB 3 リーディング システムがルビを認識し、またフォールバックを提供できるなら、<code>rp</code> 要素の使用は推奨されない。</p>
</section>

<section id="sec-xhtml-deviations-embed">
<h4><code>embed</code> 要素</h4>
<p id="confreq-html-vocab-embed">[[HTML]] <a href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-embed-element"><code>embed</code></a> 要素は、スクリプトをサポートしないリーディング システムのために、フォールバック コンテンツンツを提供するための固有の設備を提供しないので、<a>製作者</a>は、参照されたリソースにスクリプトが包含されているときは、要素の使用が推奨されない。[[HTML]] <a href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-object-element"><code>object</code> 要素</a>は、固有のフォールバック機能を包含するため、代わりに使用できる。</p>
</section>
</section>

<section id="sec-xhtml-fallbacks">
<h3>管理外リソースの制約</h3>

<p id="confreq-resources-cd-fallback">管理外リソースは、管理外リソースがサポートされていないとき、固有のフォールバック手法で代替表現を提供することが可能である場合には、固有のフォールバック メカニズムを持つ要素から参照されてもよい（MAY）。例えば、多くの [[!HTML]] <a href="https://www.w3.org/TR/html/dom.html#embedded-content">埋め込まれたコンテンツ要素</a>は、複数のソースを指定できるようにするか、リソースがレンダリングできないときのために埋め込みの HTML コンテンツを許可するなど、代替レンダリングをオプションを提供する。<a>コア メディア タイプ リソース</a>または埋め込まれた HTML コンテンツは、管理外リソースを参照するとき、特定の要素固有のフォールバック メカニズムを介して提供されなければならない（MUST）。</p>

<p id="confreq-resources-cd-fallback-media">[[!HTML]] <a href="https://www.w3.org/TR/html/dom.html#flow-content">フロー コンテンツ</a>は、（例えば、EPUB 2 リーディング システムなど）これらの要素が認められていない古いリーディング システムでレンダリングするために、<a href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-audio-element"><code>audio</code></a> 及び <a href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-video-element"><code>video</code></a> 要素内に埋め込まれてもよいが（MAY）、フォールバックのコア メディア タイプ リソースを表すものではない。</p>

<p id="confreq-resources-cd-fallback-img">[[!HTML]] <a href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-img-element"><code>img</code> 要素</a>に関連付けることができる様々なソースのために、以下のフォールバック条件がその使用に適用される。</p>

<ul>
<li><p>それが <a href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-picture-element"><code>picture</code> 要素</a>である場合、</p>
<ul>
<li>それらの属性が指定されたとき、その <code>src</code> と <code>srcset</code> 属性からコア メディア タイプ リソースを参照しなければならない（MUST）。そして、</li>
<li>各兄弟 <a href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-source-element"><code>source</code> 要素</a> は、<code>type</code> 属性でコア メディア タイプではないメディア タイプを指定しない限り、その <code>src</code> と <code>srcset</code> 属性からコア メディア タイプ リソースを参照しなければならない（MUST）。</li>
</ul>
</li>
<li>さもなければ、<a href="epub-packages.html#sec-foreign-restrictions-manifest">マニフェスト フォールバック</a> [[Packages32]] が定義されているという条件において、<code>src</code> と <code>srcset</code> 属性で管理外リソースを参照してもよい（MAY）。</li>
</ul>

<p>次の [[!HTML]] 要素は、フォールバックのコア メディア タイプ リソースを提供することなく、<a href="epub-spec.html#sec-core-media-types">管理外リソース</a> [[!EPUB32]] を参照できる。</p>

<ul>
<li><p id="confreq-resources-cd-fallback-link"><a href="https://www.w3.org/TR/html/document-metadata.html#the-link-element"><code>link</code></a> — <code>rel</code> 属性が、<a href="#confreq-cd-pls-assoc">値「<code>pronunciation</code>」</a> を持つ場合</p></li>
<li><p id="confreq-resources-cd-fallback-track"><a href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-track-element"><code>track</code></a></p></li>
<li><p id="confreq-resources-cd-fallback-video"><a href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-video-element"><code>video</code></a> — 任意の子 <a href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-source-element"><code>source</code></a> 要素を包含している</p></li>
</ul>

<p>管理外リソースは、フォールバックのコア メディア タイプ リソースの提供なしに、前述の三つの要素から参照されてもよい（MAY）。</p>

<div class="note">
<p>このような [[HTML]] <a href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-iframe-element"><code>iframe</code></a> など、固有のメカニズムのない要素のフォールバックを提供するために<a href="epub-packages.html#sec-foreign-restrictions-manifest">マニフェスト フォールバック</a> [[Packages32]] を参照されたい。</p>
</div>
</section>

<section id="sec-xhtml-forms">
<h3>フォーム送信</h3>

<p>[[!HTML]] フォームの送信に対する<a>リーディング システム</a>のサポートは、省略可能である（OPTIONAL）。例えば、リーディング システムは、ネットワークへのアクセスを制限することで、フォーム送信を防ぐかもしれない。</p>
</section>
</section>
</section>
<section id="sec-svg">
<h1>SVG コンテンツ ドキュメント</h1>

<div class="caution">
<p>[[!SVG]] の一部の機能は、<a>リーディング システム</a>において完全にサポートされていないか、リーディング システムが動作する全てのプラットフォームを横断してサポートされていない。そのような機能を利用する場合、<a>製作者</a>は、相互運用性とドキュメントの寿命への潜在的な影響の面で、固有のリスクを考慮する必要がある。</p>
</div>



<section id="sec-svg-intro" class="informative">
<h2>まえがき</h2>

<p>Scalable Vector Graphics (SVG) 仕様 [[SVG]] は、最終型のベクターグラフィックとテキストを表現するためのフォーマットを定義する。</p>

<p>EPUB 出版物は、典型的に、<a data-lt="Top-level Content Document">トップレベル</a>の文書型に <a href="#sec-xhtml">XHTML コンテンツ ドキュメント</a>を使用するが、<a>SVG コンテンツ ドキュメント</a>の使用も許可されている。SVG は、典型的に、最終型のページ画像がコンテンツの唯一な適切な表現である場合など、（例えば、カバー アート及びマンガやコミックブックのコンテクスト内など）特殊な状況でのみ使用する</p>

<p>本セクションは、[[SVG]] ドキュメントのプロファイルを定義する。この仕様に準拠した XML ドキュメントのインスタンスは<a>コア メディア タイプ リソース</a>であり、<a>SVG コンテンツ ドキュメント</a>としてこの仕様を参照している。</p>

<div class="note">
<p>本セクションは <a>SVG コンテンツ ドキュメント</a>のための適合性の制約を定義している。XHTML コンテンツ ドキュメントに埋め込まれた SVG のための適合性の制約は<a href="#sec-xhtml-svg">埋め込み SVG</a> を参照されたい。</p>
</div>

</section>

<section id="sec-svg-content-conf">
<h2>コンテンツの適合性</h2>
<p><a>SVG コンテンツ ドキュメント</a>は、次の基準を全て満たさなければならない（MUST）。</p>

<dl class="conformance-list">
<dt id="confreq-svg-docprops">ドキュメントのプロパティ</dt>
<dd><p id="confreq-cd-svg-xml"><a href="epub-spec.html#sec-xml-constraints">XML 適合性</a> [[!EPUB32]] で定義されている XML ドキュメントのための適合性の制約を満たさなければならない（MUST）。</p>
<p id="confreq-resources-svg-fallback"><a>コア メディア タイプ リソース</a>を包含するためにフォールバックを提供する<a>管理外リソース</a>への参照を包含してもよい（MAY）。</p>
<p id="confreq-cd-svg-docprops-schema"><a href="https://www.w3.org/TR/SVG/intro.html#TermSVGDocumentFragment">SVG ドキュメント フラグメント</a> [[!SVG]] であり、<a href="#sec-svg-restrictions">SVG の制限</a>で述べられている全てのコンテンツの適合性要件に準拠しなければならない（MUST）。</p>
<div class="note">
<p>[[EPUBAccessibility]] のアクセシビリティ要件に従う EPUB 出版物の推奨は、SVG コンテンツ ドキュメントに適用する。<a href="epub-spec.html#sec-epub-a11y">アクセシビリティ</a> [[EPUB32]] を見よ。</p>
</div>
</dd>

<dt id="confreq-svg-fileprops">ファイルのプロパティ</dt>
<dd><p id="confreq-svg-fileprops-name">SVG コンテンツ ドキュメントのファイル名は、ファイル拡張子 <code>.svg</code> を使用するべきである（SHOULD）。</p></dd>
</dl>
</section>

<section id="sec-svg-restrictions">
<h2>SVG の制限</h2>

<p>この仕様は、次のように <a>SVG コンテンツ ドキュメント</a>のコンテンツモデルと <a href="#sec-xhtml-svg">XHTML コンテンツ ドキュメントに埋め込む SVG</a>を制限する。</p>

<ul class="conformance-list">
<li><p id="confreq-svg-foreignObject">[[!SVG]] <a href="https://www.w3.org/TR/SVG/extend.html#ForeignObjectElement"><code>foreignObject</code></a> 要素は、次の条件を順守しなければならない（MUST）。</p>
<ul class="conformance-list">
<li><p id="confreq-svg-foreignObject-xhtml-content">[[!HTML]] <a href="https://www.w3.org/TR/html/dom.html#flow-content">フロー コンテンツ</a>かひとつの [[!HTML]] <a href="https://www.w3.org/TR/html/sections.html#the-body-element"><code>body</code> 要素</a>のいずれかを含めなければならない（MUST）。</p>
<p class="note"><a href="#sec-xhtml-svg">埋め込まれた SVG</a> の場合、<code>body</code> 要素は、[[HTML]] で定義された <a href="https://www.w3.org/TR/html/semantics-embedded-content.html#svg">SVG の制約</a>に従って許可されない。</p>
</li>
<li><p id="confreq-svg-foreignObject-xhtml-frag">コンテンツは、<a href="#sec-xhtml-conf-content">XHTML コンテンツ ドキュメント — コンテンツの適合性</a>に定義された XHTML コンテンツ ドキュメント モデルに適合する、妥当なドキュメント フラグメントでなければならない（MUST）。</p></li>
<li><p id="confreq-svg-foreignObject-reqext">もし指定されているなら、<code>requiredExtensions</code> 属性は、「<code>http://www.idpf.org/2007/ops</code>」を設定しなければならない（MUST）。</p></li>
</ul></li>
<li><p id="confreq-svg-title">[[!SVG]] <a href="https://www.w3.org/TR/SVG/struct.html#TitleElement"><code>title</code></a> 要素は、妥当な <a href="#confreq-cd-html-docprops">XHTML コンテンツ ドキュメントのフレージング コンテンツ</a>のみを含めなければならない（MUST）。</p></li>
</ul>
</section>

<section id="sec-svg-rs-conf">
<h2>リーディング システムの適合性</h2>

<p>適合した <a>EPUB リーディング システム</a>は、SVG コンテンツ ドキュメントと <a href="#sec-xhtml-svg">XHTML コンテンツ ドキュメントに埋め込む SVG</a> の処理のための次の基準を全て満たさなければならない（MUST）。</p>

<ul class="conformance-list">
<li><p id="confreq-svg-rs-behavior">上書きとしてこの仕様によって明確に定義されない限り、[[!SVG]] 仕様によって定義されたセマンティクスを使用して、SVG コンテンツ ドキュメントを処理し、その中で述べられる全ての利用可能なユーザー エージェントの適合性の制約を尊重しなければならない（MUST）。</p></li>
<li><p id="confreq-svg-rs-scrpt"><a href="#sec-scripted-content-rs-reqs">スクリプト コンテンツ ドキュメント — リーディング システムの適合性</a>で定義されているリーディング システムの適合性の基準を満たさなければならない（MUST）。</p></li>
<li><p id="confreq-svg-rs-css"><a>ビューポート</a>を持つ場合、<a href="https://www.w3.org/TR/SVG/styling.html">Styling</a> [[!SVG]] で定義されているように CSS を使用した SVG の視覚レンダリングをサポートしなければならず（MUST）、<a href="https://www.w3.org/TR/SVG/propidx.html">Property Index</a> [[!SVG]] で定義されている全てのプロパティをサポートすべきである（SHOULD）。埋め込み SVG の場合、<a href="#sec-xhtml-svg-css">埋め込み SVG と CSS</a> で定義されている制約にも適合しなければならない（MUST）。</p></li>
<li><p id="confreq-svg-rs-text">SVG 要素内にあるテキストを、ユーザーによる選択と検索をサポートするべきである（SHOULD）。</p></li>
<li><p id="confreq-svg-rs-reqdExt">（例えば属性が、<code>foreignObject</code> 要素または <code>switch</code> 要素の子に包含されるとき）XHTML コンテンツ ドキュメント フラグメントの存在を表現する <code>requiredExtensions</code> 属性の値 「<code>http://www.idpf.org/2007/ops</code>」 を認識しなければならない（MUST）。</p></li>
</ul>
</section>

<section id="sec-svg-semantic-inflection">
<h2>意味の変化</h2>
<p><a href="#sec-xhtml-semantic-inflection">XHTML の意味の変化</a>で定義された構文とセマンティクスは、<a>SVG コンテンツ ドキュメント</a>で <a href="#attrdef-epub-type"><code>epub:type</code></a> と <a href="#sec-contentdocs-prefix-attr"><code>epub:prefix</code></a> 属性を使用するために継承される。</p>
<p><code>epub:prefix</code> 属性の使用は、SVG コンテンツ ドキュメントにおけるルート <code>svg</code> 要素でのみ有効である。<a href="#sec-xhtml-svg">埋め込まれた SVG</a> で使用されるプリフィックスは、<a href="#sec-xhtml-semantic-inflection">XHTML の意味の変化</a>で定義されているように、[[!HTML]] ルートの <a href="https://www.w3.org/TR/html/semantics.html#the-html-element"><code>html</code> 要素</a>に宣言されなければならない（MUST）。</p>
</section>
</section>
<section id="sec-css">
<h1>CSS スタイル シート</h1>

<section id="sec-css-intro" class="informative">
<h2>まえがき</h2>
<p>CSS は、オープン Web プラットフォームの不可欠な一部である。読者や出版社、ドキュメントの製作者は、HTML がうまく動作するように、CSS が「うまく動作する」と期待している。</p>
<p>過去に、EPUB は、特定のプロパティのサポートを義務付け、他の多数のプロパティにおいてプレフィックス付きバージョンを提供する CSS のプロファイルを定義した。CSS ワーキング グループはプリフィックス付きプロパティの使用をもはや推奨されていないけれども、この仕様は、既存コンテンツとの断絶を避けるためにいくつかのプリフィックス付きプロパティを保持する。しかし、このセクションで定義されているマイナーな例外を除き、EPUB は、CSS を定義する W3C に従う。</p>
</section>

<section id="sec-css-content-conf">
<h2>コンテンツの適合性</h2>
<p>適合している CSS スタイル シートは、次の基準を全て満たさなければならない（MUST）。</p>
<ul class="conformance-list">
<li><p id="confreq-css-props">次の例外を除いて、任意の CSS プロパティを包含してもよい（MAY）。</p>
<ul class="conformance-list">
<li><p id="confreq-css-props-exc-direction"><a href="https://www.w3.org/TR/css3-writing-modes/#direction"><code>direction</code> プロパティ</a> [[!CSS-Writing-Modes-3]] を使用してはならない（MUST NOT）。インラインの基本方向を設定するには [[!HTML]] <a href="https://www.w3.org/TR/html/dom.html#the-dir-attribute"><code>dir</code> 属性</a>を使用する。</p></li>
<li><p id="confreq-css-props-exc-unicode-bidi"><a href="https://www.w3.org/TR/css3-writing-modes/#unicode-bidi"><code>unicode-bidi</code> プロパティ</a> [[!CSS-Writing-Modes-3]] を使用してはならない（MUST NOT）。双方向性をコントロールするには [[!HTML]] <a href="https://www.w3.org/TR/html/textlevel-semantics.html#the-bdo-element"><code>bdo</code> 要素</a>と <a href="https://www.w3.org/TR/html/dom.html#the-dir-attribute"><code>dir</code> 属性</a>を使用する。</p></li>
</ul></li>
<li><p id="confreq-css-prefixed"><a href="#sec-css-prefixed">CSS スタイル シート — プリフィックス付きプロパティ</a>で定義されているプレフィックス付きプロパティを包含してもよい（MAY）。</p></li>
<li><p id="confreq-css-encoding">UTF-8 または UTF-16 [[!Unicode]] でエンコードしなければならない（MUST）。</p></li>
</ul>

<div class="note">
<p>いくつかの<a>リーディング システム</a>は、CSS の全ての要求される機能をサポートしていないことに注意されたい。具体的には、次の問題があることが知られている。</p>
<ul>
<li>
<p>リーディング システムによって誘発されたページネーションは、スタイルシートに対して不完全に作用する。時折、ページネーションは、ビューポート サイズに対して不完全な値をもたらし、カラムに使用される。。固定及び絶対配置は、特に問題である。</p></li>
<li>
<p>スクリーンの一部のタイプは、（例えば、レイテンシが高いなど）アニメーションとトランジションを不完全にレンダリングするかもしれない。</p></li>
</ul>
</div>

</section>

<section id="sec-css-rs-conf">
<h2>リーディング システムの適合性</h2>
<p>適合した <a>EPUB リーディング システム</a>は、CSS スタイル シートを処理するために次の基準を全て満たさなければならない（MUST）。</p>
<ul class="conformance-list">
<li><p id="confreq-css-rs-support">[[!CSSSnapshot]] に記載されているような CSS の正式な定義をサポートしなければならない（MUST）。</p></li>
<li><p id="confreq-css-rs-modules">最新の<a href="https://www.w3.org/2015/Process-20150901/#candidate-rec">勧告候補</a>ステータス [[!W3CProcess]] に達しており（また、広く実装されている） [[!CSSSnapshot]] の利用可能な全てのモジュールをサポートするべきである（SHOULD）。</p></li>
<li><p id="confreq-css-rs-fonts"><code>@font-face</code> ルールから参照された [[!TrueType]]、[[!OpenType]]、[[!WOFF]] 及び [[!WOFF2]] フォント リソースをサポートしなければならない（MUST）。</p></li>
<li><p id="confreq-css-rs-prefixed"><a href="#sec-css-prefixed">CSS スタイル シート — プリフィックス付きプロパティ</a>に定義されている全てのプリフィックス付きプロパティをサポートしなければならない（MUST）。</p></li>
<li><p id="confreq-css-rs-html-default">上記で定義された CSS プロパティのサポートに加えて、そのユーザー エージェント スタイルシートは、[[!HTML]] で<a href="https://www.w3.org/TR/html/rendering.html#rendering">提案されたデフォルトのレンダリング</a>をサポートするべきである（SHOULD）。</p></li>
<li><p id="confreq-css-rs-overrides"><a href="#sec-css-rs-overrides">リーディング システムによる上書き</a>で定義されているように、著者は、CSSと ユーザー スタイルを尊重するべきである（SHOULD）。</p></li>
</ul>
<p>リーディング システムの開発者は、主要なブラウザのレベルで CSS のサポートを実装することが推奨される。</p>
</section>

<section id="sec-css-prefixed">
<h2>プリフィックス付きプロパティ</h2>

<div class="caution">
<p><a>製作者</a>は、プリフィックスのないプロパティと、現在の CSS 仕様をサポートする<a>リーディング システム</a>を使用することが強く推奨される。[[!ContentDocs301]] から広く使用されているプリフィックス付きプロパティは保留されたが、他のプロパティのサポートは取り除かれた。製作者は、必要な時に必要な場所で利用できる、取り除かれたプロパティのためのネイティブな CSS のソリューションを使用することを勧める。</p>
<p>現在、これらプリフィックス付きプロパティを使用している製作者は、これらプロパティが、EPUB の次のメジャー バージョンでサポートされる見込がないため、すぐにサポートできるプリフィックスのないバージョンに移行することが推奨される。</p>
</div>



<section id="sec-css-prefixed-writing-modes">
<h3>CSS Writing Modes</h3>
<p>次の表は、[[!CSS-Writing-Modes-3]] の <code>-epub-</code> プリフィックス付きプロパティの一覧である。値の列は、プロパティに対応する値を示している。以前の EPUB マッピングの列は、EPUB 3 の前のバージョンで使用されていた値/プロパティを示している。古いプロパティや値を意味するアスタリスク（*）は、現在は廃止されている。最後の列は、[[!CSS-Writing-Modes-3-20151215]] に基いてプリフィックス付きプロパティを実装する方法を説明している。</p>
<table>
<thead>
<tr>
<th>プロパティ</th>
<th>値</th>
<th>以前の EPUB マッピング</th>
<th>[[!CSS-Writing-Modes-3-20151215]] へのマッピング</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-epub-text-orientation</code></td>
<td><code>upright</code></td>
<td><code>upright</code></td>
<td><code>upright</code></td>
</tr>
<tr>
<td><code>-epub-text-orientation</code></td>
<td><code>mixed</code></td>
<td><code>vertical-right</code>*</td>
<td><code>mixed</code></td>
</tr>
<tr>
<td><code>-epub-text-orientation</code></td>
<td><code>sideways-right</code></td>
<td><code>sideways-right</code></td>
<td><code>sideways</code></td>
</tr>
<tr>
<td><code>-epub-text-orientation</code></td>
<td><code>sideways-right</code></td>
<td><code>rotate-right</code>*</td>
<td><code>sideways</code></td>
</tr>
<tr>
<td><code>-epub-text-orientation</code></td>
<td><code>sideways</code></td>
<td><code>rotate-normal</code>*</td>
<td><code>sideways</code></td>
</tr>
<tr>
<td><code>-epub-text-orientation</code></td>
<td><code>sideways</code></td>
<td><code>sideways</code></td>
<td><code>sideways</code></td>
</tr>
<tr>
<td><code>-epub-text-orientation</code></td>
<td><code>mixed</code></td>
<td><code>mixed</code></td>
<td><code>mixed</code></td>
</tr>
<tr>
<td><code>-epub-writing-mode</code></td>
<td><code>horizontal-tb</code></td>
<td><code>horizontal-tb</code></td>
<td><code>horizontal-tb</code></td>
</tr>
<tr>
<td><code>-epub-writing-mode</code></td>
<td><code>vertical-rl</code></td>
<td><code>vertical-rl</code></td>
<td><code>vertical-rl</code></td>
</tr>
<tr>
<td><code>-epub-writing-mode</code></td>
<td><code>vertical-lr</code></td>
<td><code>vertical-lr</code></td>
<td><code>vertical-lr</code></td>
</tr>
<tr>
<td><code>-epub-text-combine</code>*</td>
<td><code>-epub-text-combine-horizontal: none</code></td>
<td><code>none</code></td>
<td><code>text-combine-upright: none</code></td>
</tr>
<tr>
<td><code>-epub-text-combine</code>*</td>
<td><code>-epub-text-combine-horizontal: all</code></td>
<td><code>horizontal</code></td>
<td><code>text-combine-upright: all</code></td>
</tr>
<tr>
<td><code>-epub-text-combine</code>*</td>
<td>Error</td>
<td><code>horizontal &lt;number&gt;</code></td>
<td><code>text-combine-upright: digits &lt;number&gt;</code></td>
</tr>
</tbody>
</table>
</section>

<section id="sec-css-prefixed-text">
<h3>CSS Text Level 3</h3>
<table>
<thead>
<tr>
<th>プロパティ</th>
<th>値</th>
<th>[[!CSS-Text-3-20160119]] へのマッピング</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-epub-hyphens</code></td>
<td><code>none | manual | auto</code></td>
<td>変更なし</td>
</tr>
<tr>
<td><code>-epub-hyphens</code></td>
<td><code>all</code></td>
<td>非サポート</td>
</tr>
<tr>
<td><code>-epub-line-break</code></td>
<td><code>auto | loose | normal | strict</code></td>
<td>変更なし</td>
</tr>
<tr>
<td><code>-epub-text-align-last</code></td>
<td><code>auto | start | end | left | right | center | justify</code></td>
<td>変更なし</td>
</tr>
<tr>
<td><code>-epub-word-break</code></td>
<td><code>normal | keep-all | break-all</code></td>
<td>変更なし</td>
</tr>
<tr>
<td><code>text-transform</code></td>
<td><code>-epub-fullwidth</code></td>
<td><code>text-transform: full-width</code></td>
</tr>
</tbody>
</table>
</section>

<section id="sec-css-prefixed-text-decoration">
<h3>CSS Text Decoration Level 3</h3>
<table>
<thead>
<tr>
<th>プロパティ</th>
<th>値</th>
<th>[[!CSS-Text-Decor-3]] へのマッピング</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-epub-text-emphasis-color</code></td>
<td><code>&lt;color&gt;</code></td>
<td>変更なし</td>
</tr>
<tr>
<td><code>-epub-text-emphasis-position </code></td>
<td><code>[ over | under ] &amp;&amp; [ right | left ]</code></td>
<td>変更なし</td>
</tr>
<tr>
<td><code>-epub-text-emphasis-style</code></td>
<td><code>none | [ [ filled | open ] || [ dot | circle | double-circle | triangle | sesame ] ] | &lt;string&gt;</code></td>
<td>変更なし</td>
</tr>
<tr>
<td><code>-epub-text-underline-position</code></td>
<td><code>auto | [ under || [ left | right ] ]</code></td>
<td>変更なし</td>
</tr>
<tr>
<td><code>-epub-text-underline-position</code></td>
<td><code>alphabetic</code></td>
<td><code>text-underline-position: auto</code></td>
</tr>
</tbody>
</table>
<p><a href="https://www.w3.org/TR/css-values/#component-combinators">Component value combinators</a> [[!CSS-Values-3]] に定義されているプロパティ値の構文。</p>
</section>
</section>

<section id="sec-css-rs-overrides">
<h2>リーディング システムによる上書き</h2>
<p><a>EPUB リーディング システム</a>は、<a>EPUB コンテンツ ドキュメント</a>に書かれているように、<a>製作者</a>のスタイル シートを適用するべきである（SHOULD）。リーディング システムが許可している場合、ユーザーが必要に応じて製作者のスタイル シートを上書きできるようにするべきである（SHOULD）。EPUB リーディング システムは、特に必要でない限り、製作者のスタイル シートを上書きするべきではない（SHOULD NOT）。</p>
<p>リーディング システムが製作者のスタイル シートを上書きする場合、ユーザー エージェント スタイルシートや <a href="https://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/css.html#CSS-OverrideAndComputed"><code>getOverrideStyle</code> メソッド</a> [[!DOM-Level-2-Style]]、[[!HTML]] <a href="https://www.w3.org/TR/html/dom.html#the-style-attribute"><code>style</code> 属性</a>を介するカスケードを保持する方法で行うべきである（SHOULD）。</p>
<p>リーディング システムの開発者は、ユーザー エージェント スタイル シートおよび製作者のスタイル シートとやり取りする方法を、公の文書にすることを強く推奨する。</p>
</section>
</section>
<section id="sec-scripted-content">
<h1>スクリプト</h1>

<section id="sec-scripted-context">
<h2>スクリプトのコンテクスト</h2>
<p><a>EPUB コンテンツ ドキュメント</a>は、個別の基本的な仕様（[[!HTML]] と [[!SVG]]）でこのために定義された機能を使用してスクリプトを含んでもよい（MAY）。EPUB コンテンツ ドキュメントがスクリプトを含むとき、この仕様や<a>スクリプト コンテンツ ドキュメント</a>を参照する。このラベルは、それらが [[!HTML]] <a href="https://www.w3.org/TR/html/sec-forms.html#sec-forms">フォーム</a>のインスタンスを含む時、<a>XHTML コンテンツ ドキュメント</a>に適用する。</p>
<p id="sec-scripted-content-models">この仕様は、スクリプトが現れてもよい（MAY）、二つのコンテクストを定義する。</p>

<dl class="variablelist">
<dt id="sec-scripted-content-type-spine-level">スパイン レベル</dt>
<dd><p><a>トップレベル コンテンツ ドキュメント</a>に包含される [[!HTML]] の <a href="https://www.w3.org/TR/html/semantics-scripting.html#the-script-element"><code>script</code></a> または [[!SVG]] <a href="https://www.w3.org/TR/SVG/script.html#ScriptElement"><code>script</code></a> 要素のインスタンス。</p></dd>
<dt id="sec-scripted-content-type-container-constrained">コンテナ制約</dt>
<dd><p>次のいずれか。</p>
<ul>
<li>
<p>[[!HTML]] <a href="https://www.w3.org/TR/html/semantics-scripting.html#the-script-element"><code>script</code></a> 要素のインスタンスは、[[!HTML]] <a href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-iframe-element"><code>iframe</code></a> 要素を使用して親の XHTML コンテンツ ドキュメントに埋め込まれている <a>XHTML コンテンツ ドキュメント</a>に包含される。</p></li>
<li>
<p>[[!SVG]] <a href="https://www.w3.org/TR/SVG/script.html#ScriptElement"><code>script</code></a> 要素のインスタンスは、[[!HTML]] <a href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-iframe-element"><code>iframe</code></a> 要素を使用して親の XHTML コンテンツ ドキュメントに埋め込まれている <a>SVG コンテンツ ドキュメント</a>に包含される。</p></li>
</ul>
</dd>
</dl>
<p>上記の定義されたコンテクストの両方で、JavaScript のコードは、<code>script</code> 要素内に直接埋め込まれるか、<code>src</code> 属性経由で参照されているどうかで、実行するコンテクストに差はない。</p>
<p>どちらのコンテクストのスクリプトも、リーディング システムがそこに設置する権利と制約を決定して利用する。（全てのリーディング システムが同じスクリプト機能を提供するであろう）順守する必要のあるいくつかの固有の要求事項については、<a href="#sec-scripted-content-content-reqs">コンテンツの適合性</a>と<a href="#sec-scripted-content-rs-reqs">リーディング システムの適合性</a>を参照されたい。</p>

<h2>例</h2>

<aside class="example">
<p>次の例はパッケージ ドキュメントと見なす。</p>
<pre>&lt;package …&gt;
    …
    &lt;manifest&gt;
        …
        &lt;item id="chap01" 
            href="scripted01.xhtml" 
            media-type="application/xhtml+xml"
            properties="scripted"/&gt;
        &lt;item id="inset01" 
            href="scripted02.xhtml" 
            media-type="application/xhtml+xml"
            properties="scripted"/&gt;
        &lt;item id="slideshowjs" 
            href="slideshow.js" 
            media-type="text/javascript"/&gt;
    &lt;/manifest&gt;
    
    &lt;spine …&gt;
        &lt;itemref idref="chap01"/&gt;
        …
    &lt;/spine&gt;
    …
&lt;/package&gt;</pre>

<p>そして付随するファイルである <code>scripted01.xhtml</code>。</p>

<pre>&lt;html …&gt;
    &lt;head&gt;
        …
        &lt;script type="text/javascript"&gt;
            alert("Reading System name: " + navigator.epubReadingSystem.name);
        &lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        …
        &lt;iframe src="scripted02.xhtml" … /&gt;
        …
    &lt;/body&gt;
&lt;/html&gt;</pre>


<p>そして付随するファイルである <code>scripted02.xhtml</code>。</p>

<pre>&lt;html …&gt;
    &lt;head&gt;
        …
        &lt;script type="text/javascript" href="slideshow.js"&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        …
    &lt;/body&gt;
&lt;/html&gt;</pre>

<p>これらの例から、次に当てはまる。</p>
<ul>
<li>
<p>ドキュメントはスパインから参照されるので、<code>scripted01.xhtml</code> の <code>head</code> にある <code>script</code> 要素内のコードは、スパイン レベルのスクリプトであり、</p></li>
<li>
<p>そこで発生した HTML ファイルは、<code>iframe</code> 要素を介して <code>scripted01.xhtml</code> に包含されるので、<code>scripted02.xhtml</code> の <code>script</code> 要素内のコードはコンテナ制約のスクリプトである。</p></li>
</ul>
</aside>
</section>

<section id="sec-scripted-content-content-reqs">
<h2>コンテンツの適合性</h2>

<dl class="conformance-list">
<dt>コンテナ制約のスクリプト</dt>
<dd><p id="confreq-cd-scripted-container">コンテナ制約のスクリプトは、親のコンテンツ ドキュメントまたは EPUB 出版物内の他のコンテンツの DOM を変更する指示を含んではならず（MUST NOT）、含んでいる矩形のサイズを操作するための指示を含んではならない（MUST NOT）。</p></dd>
<dt>スパイン レベルのスクリプト</dt>
<dd><p id="confreq-cd-scripted-spine"><a href="#sec-scripted-content-type-spine-level">スパイン レベル</a>のスクリプトを包含している EPUB コンテンツ ドキュメントは、この仕様の目的のために次のように定義されている、<em>プログレッシブ エンハンスメントの技法</em>を利用しなければならない（MUST）。ドキュメントが、スクリプトのサポートをしない、またはスクリプトのサポートが無効になっているリーディング システムによってレンダリングされるとき、<a>トップレベル コンテンツ ドキュメント</a>は、いかなる情報も失われたり、他の重大な劣化なしに読者によって消費できるように整合性を保たなければならない（MUST）。</p></dd>
<dt>アクセシビリティ</dt>
<dd><p id="confreq-cd-scripted-a11y"><a href="#sec-scripted-content-models">スクリプトを包含している</a> EPUB コンテンツ ドキュメントは、全ての読者によって消費できるコンテンツを確保する関連性のある [[!WAI-ARIA]] アクセシビリティの技法を採用するべきである（SHOULD）。</p></dd>
<dt id="confreq-cd-scripted-flbk">フォールバック</dt>
<dd><p id="confreq-cd-scripted-fallback"><a href="#sec-scripted-content-models">スクリプトを包含している</a> EPUB コンテンツ ドキュメントは、固有のフォールバック メカニズム（例えば [[!HTML]] <a href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-object-element"><code>object</code></a> と <a href="https://www.w3.org/TR/html/semantics-scripting.html#the-canvas-element"><code>canvas</code></a> 要素のためにそれらを利用できるもの）を使用するか、それとも固有のフォールバックを適用できないとき、<a href="epub-packages.html#sec-foreign-restrictions-manifest">マニフェストレベルのフォールバック</a> [[!Packages32]] を使用して、そのようなコンテンツのためにフォールバックを提供してもよい（MAY）。</p>
<p id="confreq-cd-scripted-foreign-resources">製作者は、スクリプトが、<a href="epub-spec.html#sec-core-media-types">コア メディア タイプ リソース</a>又はフラグメントの [[!EPUB32]] を生成するだけであることを保証しなければならない（MUST）。</p></dd>
</dl>

<div class="note">
<p><a>マニフェスト</a> <code>item</code> 要素の <a href="epub-packages.html#scripted"><code>scripted</code> プロパティ</a>は、EPUB コンテンツ ドキュメントが<a>スクリプト コンテンツ ドキュメント</a>であることを示している。</p>
</div>

</section>

<section id="sec-scripted-content-rs-reqs">
<h2>リーディング システムの適合性</h2>
<p>スクリプトをサポートするリーディング システムは、次の基準を満たさなければならない（MUST）。</p>
<ul class="conformance-list">
<li><p id="confreq-rs-scripted-reflow-support">リフロー可能な EPUB コンテンツ ドキュメントは、<a href="#sec-scripted-content-type-container-constrained">コンテナ制約</a>のスクリプトをサポートするべきである（SHOULD）。</p></li>
<li><p id="confreq-rs-scripted-fxl-support"><a href="#sec-fixed-layouts">固定レイアウト ドキュメント</a>は、<a href="#sec-scripted-content-type-spine-level">スパイン レベル</a>のスクリプトをサポートするべきである（SHOULD）。</p></li>
<li><p id="confreq-rs-scripted-scrolled"><a href="epub-packages.html#flow"><code>rendition:flow</code> プロパティ</a> [[!Packages32]] によって定義された <a href="epub-packages.html#flow-scrolled-doc">「<code>scrolled-doc</code>」</a> または <a href="epub-packages.html#flow-scrolled-continuous">「<code>scrolled-continuous</code>」</a> プレゼンテーション モードを使用するリフロー可能な EPUB コンテンツ ドキュメント内におけるスパイン レベルのスクリプトをサポートするべきである（SHOULD）。同様に、リフロー可能な EPUB コンテンツ ドキュメント内におけるスパイン レベルのスクリプトをサポートする場合、「<code>scrolled-doc</code>」プレゼンテーション モードを実行しなければならなず（MUST）、「<code>scrolled-continuous</code>」プレゼンテーション モードを実行するべきである（SHOULD）。</p></li>
<li><p id="confreq-rs-scripted-optional-support">他のコンテクストでスクリプトをサポートしてもよいが（MAY）、この仕様は、そのようなスクリプトに対応していない。その結果、そのようなコンテクストにおけるスクリプトの使用は、リーディング システム間で一貫性がないかもしれない。</p></li>
<li><p id="confreq-rs-scripted-ua">[[!HTML]] に従ったスクリプトのユーザー エージェントとして、インタラクティブな<a>スクリプト コンテンツ ドキュメント</a>をレンダリングしてもよい（MAY）。</p></li>
<li><p id="confreq-rs-scripted-container">親のコンテンツ ドキュメントまたは EPUB 出版物内の他のコンテンツの DOM を変更するコンテナ制約のスクリプトを許可してはならない（MUST NOT）、含んでいる矩形のサイズを操作するための指示を包含してはならない（MUST NOT）。（注：たとえスクリプトはコンテナ制約でなくても、リーディング システムは、変更に制約を強要してもよい（MAY）（<a href="#feature-dom-manipulation">dom-manipulation 機能</a>を参照されたい）。）</p></li>
<li><p id="confreq-rs-scripted-limit">（例えば、ネットワークの制限など）スクリプトの実行時に提供される機能に追加の制限を加えてもよい（MAY）。</p></li>
<li><p id="confreq-rs-scripted-readingsystem-object"><a href="#app-epubReadingSystem">補足 A <em>JavaScript epubReadingSystem オブジェクト</em></a>で定義されている JavaScript の <code>navigator</code> 拡張オブジェクト  <code>epubReadingSystem</code> を実装しなければならない（MUST）。コンテナ制約のスクリプトのコンテクストの<a href="#app-ers-hasFeature-features">機能</a>で定義されている <code>dom-manipulation</code> と <code>layout-change</code> 機能もサポートしなければならない（MUST）。</p></li>
</ul>
<p>スクリプトをサポートしないリーディング システムは、次の基準を満たさなければならない（MUST）。</p>
<ul class="conformance-list">
<li><p id="confreq-rs-scripted-flbk"><a href="#confreq-cd-scripted-flbk">スクリプト コンテンツ ドキュメントのためのフォールバック</a>で定義されているスクリプトコンテンツのためのフォールバックを処理をしなければならない（MUST）。</p></li>
</ul>

<div class="note">
<p>リーディング システムは、他の EPUB の機能を無効にしたり、または（例えば、改ページの無効による）異なるレンダリングやユーザーエクスペリエンスを提供する方法でスクリプト コンテンツ ドキュメントをレンダリングするかもしれない。</p>
<p><a href="#sec-scripted-content-type-container-constrained">コンテナ制約</a>モデルの使用を制限を選択する製作者は、スクリプトと非スクリプトコンテンツの間でより一貫性のあるユーザーエクスペリエンス（例えば、一貫性のあるページネーションの挙動）を確保するであろう。</p>
<p>製作者は、これらの EPUB 出版物の互換性や寿命、アクセシビリティを向上させ、可能な時はスクリプトの包含を避ける現実的な宣言の技法を使用することを勧める。</p>
</div>

</section>

<section id="sec-scripted-content-security" class="informative">
<h2>セキュリティの考慮事項</h2>
<p>全ての EPUB <a>製作者</a>と <a>EPUB リーディング システム</a>の開発者は、スクリプトコンテンツが、リーディング システムによって実行されるときに発生するセキュリティ問題に注意する必要がある。リーディング システムとブラウザによって採用されている基本的なスクリプトモデルが同じであるように、Web コンテクスト内で発生した問題と同じ種類を考慮する必要がある。</p>
<p>各リーディング システムは、特定のドキュメント内のスクリプトが信頼できるかそうでないかを、はっきりさせる必要がある。全てのスクリプトが、信頼できない（そして潜在的に悪意のある）ものとして処理され、攻撃の全てのベクトルが分析され、保護されるのを勧める。具体的には、次を考慮する必要がある。</p>
<ul>
<li>
<p>ランタイム環境への攻撃（例えば、ユーザーのハードドライブからファイルを盗む）、</p></li>
<li>
<p>リーディング システム自体への攻撃（例えば、読者の本のリストを盗んだりまたは予想外の動作を引き起こす）、</p></li>
<li>
<p>他に対するあるコンテンツ ドキュメントの攻撃（例えば、他のドキュメントに存在するデータを盗む）、</p></li>
<li>
<p>ドキュメントの暗号化された部分に対する非暗号化のスクリプトの攻撃（例えば、保護されているコンテンツを抽出する悪意のあるスクリプトの注入）、</p></li>
<li>
<p>ローカル ネットワークへの攻撃（例えば、ファイア ウォールの背後にあるサーバからデータを盗む）。</p></li>
</ul>
<p>次の推奨事項は、信頼できないスクリプトを処理するためのガイドとして提供する。</p>
<ul>
<li>
<p>ブラウザベースのセキュリティは、ドキュメントの URL とドメインに大きく依存してるように、一意のドメインが各コンテンツ ドキュメントに割り当てられているように、リーディング システムは動作する必要がある。この提案を採用することで、外部 URL やクッキー、DOM ストレージなどへアクセスを制限して、互いと他のインターネットドメインからドキュメントを分離する。</p>
<p>スクリプトとネットワークアクセスが有効なリーディング システムは、ネットワークのアクティビティが発生していること、そして/または、それらを無効にできることを読者に通知する手法の包含をもまた考慮する必要がある。</p>
<div class="note">
<p>実際のところ、リーディング システムは、ドキュメントを跨いでドメインを共有するかもしれないが、それらはまだドキュメント間の分離を維持する必要がある。</p>
<p>ドキュメンの一部が暗号化され、そして他の一部がそうでないとき、または異なる暗号化キーがドキュメントの異なる部分に使用されているとき、一意のドキュメントごとのドメインは、十分な保護が提供できないかもしれない。</p>
</div>
</li>
<li>
<p>リーディング システムに永続的なデータの保存を許可するとき、そのデータを慎重に処理する必要がある。スクリプトは、クッキーや DOM ストレージを通じて永続的なデータを保存するかもしれないが、リーディング システムは、そのような試みをブロックするかもしれない。データの保存を許可しているリーディング システムは、他の関係のないドキュメント（例えば、偽装されているもの）で利用することができないことを保証する必要がある。具体的には、一致するドキュメントの識別子（もしくは同様のメタデータ）のチェックは、永続的なデータへのアクセスを制御するのに妥当な方法ではない。</p>
<p>ローカルストレージを許可しているリーディング システムは、読者のためにデータの調査、無効化または削除の手段としても提供する必要ある。対象の EPUB 出版物を削除するとき、それのデータは破壊される必要がある。</p></li>
</ul>
<p>これらの推奨事項への順守は、上に挙げた可能性のある攻撃からの保護を保証しないことを注意されたい。開発者は、それらのリーディング システムのコンテクスト内のそれぞれの潜在的な脆弱性を調査する必要がある。</p>
</section>

<section id="sec-scripted-content-events" class="informative">
<h2>イベントモデルの考慮事項</h2>
<p>リーディング システムは、[[HTML]] のような DOM のイベントモデルに従い、これらのイベントに関連付けられている標準のアクションを実行する前に、スクリプト環境に UI イベントを渡す必要がある。リーディング システムの開発者は、<a href="#sec-scripted-content-security">潜在的に悪意</a>のあるスクリプトがこれらのリーディング システムに影響を与えることができる範囲を制限するために、スクリプトが重要な機能（たとえばナビゲーションなど）を無効にできないことも保証する必要がある。結果として、スクリプト環境は、いかなるイベントの標準アクションをキャンセルできる必要はあるが、一部のイベントは通過させないかもしれないしキャンセルできないかもしれない。</p>
<p><a>製作者</a>は、これらの EPUB 出版物にスクリプト機能を加えるとき、リーディング システムの実装の可能性を考慮する必要がある。（例えば、デバイスの全てが物理キーボードを備えているわけではなく、多くの場合、ソフトウェアキーボードが、テキストのインプット要素のためのみに有効化される）。したがって、キーボードのイベントのみに頼るのは勧めない。目的のアクションのトリガーとなる代替の方法は、常に提供される必要がある。</p>
</section>
</section>
<section id="sec-fixed-layouts">
<h1>固定レイアウト</h1>

<section id="sec-fxl-overview" class="informative">
<h2>まえがき</h2>
<p>このセクションは、<a>パッケージ ドキュメント</a>に <code>pre-paginated</code> として示された <a>固定レイアウト ドキュメント</a> — <a>EPUB コンテンツ ドキュメント</a>の大きさのプロパティの表現と解釈のための規則を定義する。</p>
<p>この仕様は、<a href="https://www.w3.org/TR/CSS2/visudet.html#containing-block-details">初期包含ブロック</a> [[CSS2]] がどのようにリーディング システムの<a>コンテンツ表示領域</a>内に配置されるかを定義しない。</p>

<div class="note">
<p>ページ分割された様式（つまり、固定の幅や高さの大きさを持つ）でレンダリングされる<a>レンディション</a>または個々のスパイン項目を指定する方法についての情報は<a href="epub-packages.html#sec-package-metadata-fxl">固定レイアウト プロパティ</a> [[Packages32]] を参照されたい。</p>
</div>

</section>

<section id="sec-fxl-content-conf">
<h2>コンテンツの適合性</h2>
<p>適合した<a>固定レイアウト ドキュメント</a>は、次の基準を全て満たさなければならない（MUST）。</p>
<ul class="conformance-list">
<li>
<p><a href="#sec-fxl-html-svg-dimensions">初期包含ブロックの大きさ</a>に定義されているような<a href="https://www.w3.org/TR/CSS2/visudet.html#containing-block-details">初期包含ブロック</a> [[!CSS2]] を指定しなければならない（MUST）。</p></li>
</ul>
</section>

<section id="sec-fxl-rs-conf">
<h2>リーディング システムの適合性</h2>
<p>適合した <a>EPUB リーディング システム</a>は、<a>固定レイアウト ドキュメント</a>を処理するための次の基準を全て満たさなければならない（MUST）。</p>
<ul class="conformance-list">
<li><p id="confreq-fxl-rs-viewport"><a href="#sec-fxl-viewport">ビューポートのレンダリング</a>に定義されているように、ドキュメントに全ての<a>コンテンツ表示領域</a>を割り当てるべきである（SHOULD）。</p></li>
<li><p id="confreq-fxl-rs-html"><a href="#sec-fxl-icb-html">HTML に ICB を表現する</a>で定義されているように、<a>XHTML コンテンツ ドキュメント</a>をレンダリングするのに <code>viewport</code> <code>meta</code> 内で表現する大きさを使用しなければならない（MUST）。</p></li>
<li><p id="confreq-fxl-rs-svg"><a>SVG コンテンツ ドキュメント</a>をレンダリングするのに <a href="#sec-fxl-icb-svg">SVG に ICB を表現する</a>で定義されているような大きさを使用しなければならない（MUST）。</p></li>
</ul>
</section>

<section id="sec-fxl-viewport">
<h2>ビューポートのレンダリング</h2>
<p><a>固定レイアウト ドキュメント</a>をレンダリングするとき、デフォルトの意図は、<a>コンテンツ表示領域</a>を可能な限り、使用可能な<a>ビューポート</a> エリアの多くを占めるようにするべきである（SHOULD）。<a>リーディング システム</a>は、ビューポートに例えばボーダーまたはマージン、ヘッダー、フッターなどの追加のコンテンツを入れるべきではない（SHOULD NOT）。</p>

<div class="note">
<p>ユーザーへのリーディング システムをコントロールするウィジェットは、上記の期待される挙動に包含されていない。</p>
</div>

</section>

<section id="sec-fxl-html-svg-dimensions">
<h2>初期包含ブロックの大きさ</h2>

<section id="sec-fxl-icb-html">
<h3>HTML の表現</h3>
<p>XHTML の<a>固定レイアウト ドキュメント</a>の場合、<a href="https://www.w3.org/TR/CSS2/visudet.html#containing-block-details">初期包含ブロック</a> [[!CSS2]] の大きさは、[[!CSS-Device-Adapt-1]] に定義された構文を使用して <code>viewport</code> <code>meta</code> タグで表現されなければならない（MUST）。この仕様のこの版では、幅と高さの表現のみ、<a>リーディング システム</a>によって認識されなければならない（MUST）。</p>

<aside class="example">
<p>次の例は、<code>viewport</code> <code>meta</code> タグを示している。</p>
<pre>
&lt;head&gt;
   …
   &lt;meta name="viewport" content="width=1200, height=600"/&gt;
   …
&lt;/head&gt;</pre>
</aside>


<p>リーディング システムは、<code>viewport</code> <code>meta</code> タグで宣言された初期包含ブロック（ICB）の大きさに XHTML コンテンツを切り抜かなければならない（MUST）。初期包含ブロックの外側に位置するコンテンツは見えないであろう。ICB のアスペクト比がリーディング システムの<a>コンテンツ表示領域</a>のアスペクト比と一致していないとき、リーディング システムはユーザインタフェースに順応するため領域内の ICB を配置してもよく（MAY）、つまり、レターボックスがコンテンツの片側もしくは両側に表示されてもよい（MAY）。</p>
</section>

<section id="sec-fxl-icb-svg">
<h3>SVG の寸法</h3>
<p>SVG <a>固定レイアウト ドキュメント</a>の場合、ICB の大きさは、<a href="http://www.w3.org/TR/SVG/coords.html#ViewBoxAttribute"><code>viewBox</code> 属性</a> [[!SVG]] を使用して表現しなければならない（MUST）。</p>

<aside class="example">
<p>次の例は、高さ 1200 ピクセルに従って幅 844 ピクセルのアスペクト比を持つ SVG コンテンツ ドキュメント のための <code>viewBox</code> 属性の宣言を示している。</p>
<pre>
&lt;svg xmlns="http://www.w3.org/2000/svg"
     version="1.1" 
     viewBox="0 0 844 1200"&gt;
   …
&lt;/svg&gt;</pre>
</aside>
</section>
</section>
</section>
<section id="sec-pls">
<h1>発音辞書</h1>

<section id="sec-pls-intro" class="informative">
<h2>まえがき</h2>
<p>W3C 発音辞書仕様 (PLS) [[PRONUNCIATION-LEXICON]] は、自動音声認識と<a>テキスト読み上げ</a>（TTS）エンジンの使用による XML ベースの発音辞書のための構文とセマンティクスを定義している。</p>
<p>次のセクションは、<a>EPUB 出版物</a>を包含している PLS ドキュメントのための基準と、<a>XHTML コンテンツ ドキュメント</a>に PLS ドキュメントを結びつけるためのルールの適合性を定義している。</p>

<div class="note">
<p>合成音声に関連する EPUB 3 の機能の詳細な情報は、<a href="epub-overview.html#sec-tts">テキスト読み上げ</a> [[EPUB3Overview]] を参照されたい。</p>
</div>

</section>

<section id="sec-pls-conf-pub">
<h2>EPUB 出版物の適合性</h2>
<p>適合した <a>EPUB 出版物</a>の<a>レンディション</a>は、<abbr title="Pronunciation Lexicon Specification">PLS</abbr> ドキュメントに含むために次の基準を全て満たさなければならない（MUST）。</p>
<ul class="conformance-list">
<li><p id="confreq-cd-pls-xht">PLS ドキュメントは、<a>XHTML コンテンツ ドキュメント</a>に関連付けてよい（MAY）。それぞれの XHTML コンテンツ ドキュメントは、0以上の PLS ドキュメントを関連付けて含んでもよい（MAY）。</p></li>
<li><p id="confreq-cd-pls-assoc">PLS ドキュメントは、「<code>pronunciation</code>」に設定される <code>rel</code> 属性を持った [[!HTML]] の <a href="https://www.w3.org/TR/html/document-metadata.html#the-link-element"><code>link</code></a> 要素とメディア タイプ「<code>application/pls+xml</code>」に設定される <code>type</code> 属性を使用して、それを適用した <a>XHTML コンテンツ ドキュメント</a>に関連付けられねばならない（MUST）。</p>
<p id="confreq-cd-pls-assoc-lang"><code>link</code> 要素 <code>hreflang</code> 属性 それぞれの <code>link</code> に指定するべきであり（SHOULD）、その値が指定されたとき、<a href="https://www.w3.org/TR/2008/REC-pronunciation-lexicon-20081014/#S4.1">発音辞書が関連している言語</a> [[!PRONUNCIATION-LEXICON]] に一致しなければならない（MUST）。</p></li>
<li><p id="confreq-pls-pub-cont">PLS ドキュメントは、<a href="#sec-pls-conf-content">PLS ドキュメント — コンテンツの適合性</a> で定義されたコンテンツの適合性の基準に満たさなければならない（MUST）。</p></li>
<li><p id="confreq-pls-pub-manif">PLS ドキュメントは、<a href="epub-packages.html#sec-package-conformance">EPUB パッケージ — 適合性</a> [[!Packages32]] で定義されているような表現と配置にしなければならない（MUST）。</p></li>
</ul>

<section id="pls-examples">
<h3>例</h3>

<aside class="example">
<p>次の例は、XHTML コンテンツ ドキュメントに関連付けられた二つの <abbr title="Pronunciation Lexicon Specification">PLS</abbr> ドキュメント（中国語とモンゴル語のためのもの）を示している。</p>
<pre>
&lt;html … &gt;    
    &lt;head&gt;
        …
        &lt;link rel="pronunciation" type="application/pls+xml" hreflang="zh" href="../speech/zh.pls"/&gt;
        &lt;link rel="pronunciation" type="application/pls+xml" hreflang="mn" href="../speech/mn.pls"/&gt;
    &lt;/head&gt;        
    …
&lt;/html&gt;</pre>
</aside>
</section>
</section>

<section id="sec-pls-conf-content">
<h2>コンテンツの適合性</h2>
<p><abbr title="Pronunciation Lexicon Specification">PLS</abbr> ドキュメントは次の基準を全て満たさなければならない（MUST）。</p>

<dl class="conformance-list">
<dt id="confreq-cd-pls-docprops">ドキュメントのプロパティ</dt>
<dd><p id="confreq-cd-pls-xml"><a href="epub-spec.html#sec-xml-constraints">XML 適合性</a> [[!EPUB32]] で定義された XML ドキュメントための適合性の制約を満たさなければならない（MUST）。</p>
<p id="confreq-cd-pls-docprops-schema">URI <a class="uri" href="https://www.w3.org/TR/2008/REC-pronunciation-lexicon-20081014/pls.rng"><code>https://www.w3.org/TR/2008/REC-pronunciation-lexicon-20081014/</code></a> [[!PRONUNCIATION-LEXICON]] で利用できる PLS ドキュメントのための RELAX NG スキーマに妥当でなければならない（MUST）。</p></dd>
<dt id="confreq-cd-pls-fileprops">ファイルのプロパティ</dt>
<dd><p id="confreq-cd-pls-fileprops-name">PLS ドキュメントのファイル名はファイル拡張子の <code class="filename">.pls</code> を使用するべきである（SHOULD）。</p></dd>
</dl>
</section>

<section id="sec-pls-conf-rs">
<h2>リーディング システムの適合性</h2>
<p>テキスト読み上げ（TTS）機能を持つリーディングシステムは、<abbr title="Pronunciation Lexicon Specification">PLS</abbr> ドキュメントをサポートするべきである（SHOULD）。</p>
<p>適合した <a>EPUB リーディング システム</a>は、PLS ドキュメントの処理のための次の基準を全て満たさなければならない（MUST）。</p>
<ul class="conformance-list">
<li><p id="confreq-pls-rs-sptts"><a>テキスト読み上げ</a>（TTS）機能を持ったリーディング システムは、[[!PRONUNCIATION-LEXICON]] をサポートするべきである（SHOULD）。</p>
<p id="confreq-pls-rs-proc">[[!PRONUNCIATION-LEXICON]] で定義されているように PLS ドキュメントを処理しなければならない（MUST）。</p>
<p id="confreq-pls-rs-scope"><a href="https://www.w3.org/TR/2008/REC-pronunciation-lexicon-20081014/#S4.1">発音辞書が関連している言語</a> [[!PRONUNCIATION-LEXICON]] に一致する <a href="https://www.w3.org/TR/html/dom.html#the-lang-and-xmllang-attributes">language</a> [[!HTML]] は現在の XHTML コンテンツ ドキュメント内の全てのテキストノードに供給された発音命令を適用しなければならない（MUST）。言語タグを一致させるためのアルゴリズムは [[!BCP47]] で定義されている。</p>
<p id="confreq-pls-rs-multi">発音ルールが、特定の言語に特定の文字列の対象に対して複数指定されているとき、任意の事前に定義された発音ルールが上書きされるように、ルールの最後の発生を優先しなければならない（MUST）。</p>
<p id="confreq-pls-rs-casc"><a href="#sec-xhtml-ssml-attrib">SSML 属性</a>をサポートする場合、<a href="#sec-cd-ssml-ph-attrib"><code>ssml:ph</code></a> 属性経由で提供される任意の発音命令が <code>ssml:ph</code> 属性 [[!SSML]] を含んでいる要素のテキストノードに一致する <code>grapheme</code> 要素 [[!PRONUNCIATION-LEXICON]] に優先することを許可しなければならない（MUST）。</p></li>
</ul>
</section>
</section>
<section class="appendix" id="app-epubReadingSystem">
<h1>JavaScript <dfn>epubReadingSystem</dfn> オブジェクト</h1>

<section id="app-ers-idl">
<h2>インターフェースの定義</h2>

<p>この仕様は、次のように、[[!HTML]] <dfn>Navigator</dfn> オブジェクトを拡張する。</p>

<pre class="idl">[Exposed=(Window)]
interface EpubReadingSystem {
    [Unforgeable] readonly attribute DOMString name;
    [Unforgeable] readonly attribute DOMString version;
    boolean hasFeature(DOMString feature, optional DOMString version);
};

partial interface Navigator {
    [Unforgeable, SameObject] readonly attribute EpubReadingSystem epubReadingSystem;
};</pre>
<p>[[!WEBIDL]] notation.</p>

<div class="note">
<p>この仕様は、<a href="https://www.w3.org/TR/2015/WD-workers-20150924/#the-workernavigator-object"><code>WorkerNavigator</code> オブジェクト</a> [[WebWorkers]] の <code>epubReadingSystem</code> プロパティ拡張を定義していない。したがって、リーディング システムは、ワーカーのスクリプト コンテクストで <code>epubReadingSystem</code> オブジェクトの公開を必要とせず、製作者は、その存在に依存することはできない。</p>
</div>

</section>

<section id="app-ers-desc">
<h2>概要</h2>

<p><code><dfn>Navigator.epubReadingSystem</dfn></code> オブジェクトは、<a>スクリプト コンテンツ ドキュメント</a>が、ユーザーの<a>リーディング システム</a>に関する情報を照会できるインターフェースを提供する。</p>

<p>オブジェクトは、リーディング システムの<a href="#app-ers-properties">プロパティ</a>（名前とバージョン）を表示し、そのサポートする機能を決定するために呼び出すことができる <a href="#app-ers-hasFeature"><code>hasFeature</code> メソッド</a>を提供する。</p>

<aside class="example">
<p>現在のリーディング システムの名前を表示させる JavaScript の関数の例。</p>

<pre>alert("Reading System name: " + navigator.epubReadingSystem.name);</pre>
</aside>

<p>リーディング システムは、ネストされた<a href="#sec-scripted-content-type-container-constrained">コンテナ制約</a>のスクリプト コンテクストを包含する、ロードされた全てのスクリプト コンテント ドキュメントの <code>navigator</code> オブジェクト上に <code>epubReadingSystem</code> オブジェクトを公開しなければならない（MUST）。リーディング システムは、<a href="https://www.w3.org/TR/html/syntax.html#the-end"><code>DOMContentLoaded</code> イベントがトリガー</a> [[!HTML]] されたときよりも遅延することなく、<code>epubReadingSystem</code> オブジェクトを利用できることを担保しなければならない（MUST）。</p>

<div class="note">
<p>リーディング システムの実装は、技術的な実現可能性の理由から、スクリプト コンテンツ ドキュメント内に <code>epubReadingSystem</code> オブジェクトの複製されたインスタンスを作るかもしれない。このような場合に、リーディング システムは、（そのプロパティとメソッドの値によって反映されるように）オブジェクトの状態が一貫してコピーされた全てのインスタンス間で維持されることを保証する必要がある。</p>
</div>
</section>

<section id="app-ers-properties">
<h2>プロパティ</h2>

<p>次のプロパティで、リーディング システムに関する情報を読み出せるようにしなければならない（MUST）。</p>

<table data-dfn-for="epubReadingSystem">
<thead>
<tr>
<th>名前</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td id="propdef-name"><code><dfn>name</dfn></code></td>
<td>リーディング システム（例えば、"<code>iBooks</code>" や "<code>Kindle</code>"）の名前を表す <code>String</code> 値を返す。</td>
</tr>
<tr>
<td id="propdef-version"><code><dfn>version</dfn></code></td>
<td>リーディング システム（例えば、"<code>1.0</code>", "<code>2.1.1</code>"）のバージョンを表す <code>String</code> 値を返す。</td>
</tr>
<tr>
<td id="propdef-layoutStyle"><code><dfn>layoutStyle</dfn></code></td>
<td><code>layoutStyle</code> プロパティの使用は、非推奨（<a href="epub-spec.html#deprecated">deprecated</a>）である。使用例の情報は、[[!ContentDocs301]] の定義を参照されたい。</td>
</tr>
</tbody>
</table>
</section>

<section id="app-ers-methods">
<h2>メソッド</h2>

<section id="app-ers-hasFeature">
<h3>hasFeature</h3>

<section id="app-ers-hasFeature-desc">
<h4>概要</h4>

<p data-dfn-for="epubReadingSystem"><code><dfn>hasFeature</dfn></code> メソッドは、指定された機能のいずれかのバージョンがサポートされているかどうかを示すブーリアン値、または指定した機能が認識されない場合は <code>undefined</code> を返す。</p>

<p>省略可能な（OPTIONAL) <code>version</code> パラメータは、時間とともに互換性のない方法で変更できるカスタム機能を問い合わせるために包含されている。返り値は、機能の特定のバージョンのみサポートすることを示している。</p>

<p><a>製作者</a>は、<a href="#app-ers-hasFeature-features">この仕様に定義された機能</a>を問い合わせるとき、<code>version</code> パラメータを包含するべきではない（SHOULD NOT）。これらの機能は、バージョンを持たないと見なされる。リーディング システムがこの仕様に定義された機能をサポートしない場合、全ての提供された <code>version</code> パラメータと <code>true</code> 値の返りを無視しなければならない（MUST）。</p>

<aside class="example">
<p>現在のリーディング システムが DOM のスクリプト操作をサポートしているかどうかを表す JavaScript の関数の例。</p>

<pre>var feature = "dom-manipulation";

var conformTest = navigator.epubReadingSystem.hasFeature(feature);

alert("Feature " + feature + " supported?: " + conformTest);</pre>
</aside>
</section>

<section id="app-ers-hasFeature-features">
<h4>機能</h4>

<p>次の表は、<code>epubReadingSystem</code> オブジェクトをサポートするリーディング システムが（戻り値を提供するため）認識しなければならない（MUST）機能のセットを掲載している。これらの機能のサポートは、省略可能（OPTIONAL）である。</p>

<table>
<thead>
<tr>
<th>名前</th>
<th>概要</th>
</tr>
</thead>
<tbody>
<tr>
<td id="feature-dom-manipulation"><code>dom-manipulation</code></td>
<td>スクリプトは、ドキュメントの DOM（<a href="#sec-scripted-content-type-spine-level">スパイン レベルのスクリプト</a>のみ適用される）に構造の変更をしてもよい（MAY）。</td>
</tr>
<tr>
<td id="feature-layout-changes"><code>layout-changes</code></td>
<td>スクリプトは、コンテンツのレイアウト（<a href="#sec-scripted-content-type-spine-level">スパイン レベルのスクリプト</a>のみ適用される）に影響を及ぼす属性と CSS スタイルの変更をしてもよい（MAY）。</td>
</tr>
<tr>
<td id="feature-touch-events"><code>touch-events</code></td>
<td>デバイスはタッチイベントをサポートしており、リーディング システムは、コンテンツにタッチイベントを渡す。</td>
</tr>
<tr>
<td id="feature-mouse-events"><code>mouse-events</code></td>
<td>デバイスはマウスイベントをサポートしており、リーディング システムはコンテンツにマウスイベントを渡す。</td>
</tr>
<tr>
<td id="feature-keyboard-events"><code>keyboard-events</code></td>
<td>デバイスはキーボードイベントをサポートしており、リーディング システムはコンテンツにキーボードイベントを渡す。</td>
</tr>
<tr>
<td id="feature-spine-scripting"><code>spine-scripting</code></td>
<td>リーディング システムが、（例えば、<a href="#sec-scripted-content-type-container-constrained">コンテナ制約のスクリプト</a>は、<a>トップレベル コンテンツ ドキュメント</a>内でサポートしているスクリプトに依存している全てのアクションが、それらを試みる前に達成のチャンスがあるかどうか決定できる）<a href="#sec-scripted-content-type-spine-level">スパイン レベルのスクリプト</a>をサポートするかどうかを示す。</td>
</tr>
</tbody>
</table>

<p>追加機能は、リーディング システムの開発者により加えられてもよいが（MAY）、この仕様の将来のバージョンで、そのようなカスタムの追加と競合したり互換性のない方法でこの一覧に追加するかもしれない。</p>
</section>
</section>
</section>
</section>
<div data-include="acknowledgements.html" data-oninclude="fixIncludes" data-include-replace="true"></div>
</body>
</html>
